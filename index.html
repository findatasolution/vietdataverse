<!DOCTYPE html>
<html lang="vi">
<head>
    <!-- Google search -->
    <meta name="google-site-verification" content="w7LUdUQqy_s1GEK4xpKPy8KSuyNMWFLz9bMuMyhtnNQ" />
    <!-- Google Analytics (GA4) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YB3PKHN2E5"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-YB3PKHN2E5');
    gtag('config', 'G-B9BHYSYDES');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tải Lịch Sử Giá Vàng Miễn Phí | Download Gold Price Vietnam CSV | Viet Dataverse</title>
    <meta name="description" content="Tải lịch sử giá vàng SJC, DOJI, BTMC miễn phí từ 2015. Download Vietnam gold price CSV, giá bạc Phú Quý, lãi suất ngân hàng. Cập nhật 2 lần/ngày, hỗ trợ API & export.">
    <meta name="keywords" content="tải giá vàng, download gold price, tải lịch sử giá vàng, download vietnam gold price, giá vàng hôm nay, gold price today vietnam, tải giá vàng csv, download gold price csv, lịch sử giá vàng sjc, giá vàng sjc hôm nay, gold price api, tải giá vàng miễn phí, free gold price download, vàng doji, vàng btmc, giá vàng pnj, download silver price vietnam, tải giá bạc, lãi suất ngân hàng, vietnam economic data, vietdataverse, viet dataverse">
    <meta name="author" content="Viet Dataverse">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="language" content="Vietnamese">
    <meta name="geo.region" content="VN">
    <meta name="geo.placename" content="Vietnam">
    <!-- nháp -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6080033337103483"
     crossorigin="anonymous"></script>
    <!-- end nháp -->
    <!-- Favicon and Icons (hosted on imagekit.io) -->
    <link rel="icon" type="image/png" sizes="16x16" href="https://ik.imagekit.io/o2u9hny2s/vietdataverse/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://ik.imagekit.io/o2u9hny2s/vietdataverse/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://ik.imagekit.io/o2u9hny2s/vietdataverse/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="https://ik.imagekit.io/o2u9hny2s/vietdataverse/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="https://ik.imagekit.io/o2u9hny2s/vietdataverse/icon-512.png">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    <meta name="theme-color" content="#C9A55B">
    <meta name="msapplication-TileColor" content="#C9A55B">
    <meta name="msapplication-TileImage" content="https://ik.imagekit.io/o2u9hny2s/vietdataverse/icon-512.png">

    <link rel="canonical" href="https://vietdataverse.online/">
    <link rel="alternate" hreflang="vi" href="https://vietdataverse.online/">
    <link rel="alternate" hreflang="en" href="https://vietdataverse.online/">
    <link rel="alternate" hreflang="x-default" href="https://vietdataverse.online/">

    <!-- Open Graph for social sharing -->
    <meta property="og:site_name" content="Viet Dataverse">
    <meta property="og:title" content="Tải Giá Vàng Miễn Phí | Download Gold Price Vietnam CSV | Viet Dataverse">
    <meta property="og:description" content="Tải giá vàng SJC, DOJI, BTMC miễn phí từ 2015. Download Vietnam gold price CSV, giá bạc Phú Quý, lãi suất ngân hàng. Cập nhật 2 lần/ngày, API & export.">
    <meta property="og:image" content="https://ik.imagekit.io/o2u9hny2s/vietdataverse/V2.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Viet Dataverse - Vietnam Economic Data Platform">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://vietdataverse.online/">
    <meta property="og:locale" content="vi_VN">
    <meta property="og:locale:alternate" content="en_US">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@VietDataverse">
    <meta name="twitter:creator" content="@VietDataverse">
    <meta name="twitter:title" content="Tải Giá Vàng Miễn Phí | Download Gold Price Vietnam CSV">
    <meta name="twitter:description" content="Tải giá vàng SJC, DOJI, BTMC miễn phí. Download Vietnam gold price CSV từ 2015. Free API & export cho nghiên cứu kinh tế.">
    <meta name="twitter:image" content="https://ik.imagekit.io/o2u9hny2s/vietdataverse/V2.png">
    <meta name="twitter:image:alt" content="Viet Dataverse Logo">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://api.vietdataverse.online" crossorigin>
    <link rel="dns-prefetch" href="https://api.vietdataverse.online">
    <link rel="preload" href="style.css" as="style">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>

    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Viet Dataverse",
      "alternateName": ["VietDataverse", "vietdataverse", "Tải Giá Vàng", "Download Gold Price Vietnam"],
      "url": "https://vietdataverse.online/",
      "description": "Tải lịch sử giá vàng SJC, DOJI, BTMC miễn phí từ 2015. Download Vietnam gold price CSV, giá bạc, lãi suất ngân hàng. Cập nhật 2 lần/ngày.",
      "inLanguage": "vi-VN",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://vietdataverse.online/?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Dataset",
      "name": "Tải Giá Vàng Việt Nam Miễn Phí - Download Vietnam Gold Price CSV",
      "description": "Tải lịch sử giá vàng SJC, DOJI, BTMC từ 2015 miễn phí. Download Vietnam gold price data CSV cập nhật 2 lần mỗi ngày. Free API & CSV export cho nghiên cứu kinh tế.",
      "url": "https://vietdataverse.online/",
      "keywords": ["tải giá vàng", "download gold price", "tải lịch sử giá vàng", "download vietnam gold price", "giá vàng csv", "gold price csv download", "vietnam gold price data", "lịch sử giá vàng sjc", "gold price api vietnam", "giá vàng hôm nay", "free gold price download"],
      "creator": {
        "@type": "Organization",
        "name": "Viet Dataverse"
      },
      "distribution": [
        {
          "@type": "DataDownload",
          "encodingFormat": "CSV",
          "contentUrl": "https://api.vietdataverse.online/api/v1/gold",
          "name": "Tải dữ liệu giá vàng CSV",
          "description": "Download Vietnam gold price historical data"
        },
        {
          "@type": "DataDownload",
          "encodingFormat": "application/json",
          "contentUrl": "https://api.vietdataverse.online/api/v1/gold",
          "name": "Gold Price API",
          "description": "RESTful API for Vietnam historical gold prices"
        }
      ],
      "temporalCoverage": "2015/..",
      "spatialCoverage": {
        "@type": "Place",
        "name": "Vietnam"
      }
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Dataset",
      "name": "Dữ Liệu Giá Bạc Phú Quý Việt Nam",
      "description": "Lịch sử giá bạc thỏi Phú Quý tại thị trường Việt Nam, cập nhật 2 lần mỗi ngày từ nguồn công khai",
      "url": "https://vietdataverse.online/",
      "keywords": ["giá bạc", "giá bạc hôm nay", "bạc Phú Quý", "giá bạc thỏi"],
      "creator": {
        "@type": "Organization",
        "name": "Viet Dataverse"
      },
      "distribution": {
        "@type": "DataDownload",
        "encodingFormat": "CSV",
        "contentUrl": "https://api.vietdataverse.online/api/v1/silver"
      }
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Giá vàng SJC hôm nay là bao nhiêu?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Viet Dataverse cung cấp giá vàng trong nước được cập nhật hàng ngày. Bạn có thể xem biểu đồ lịch sử và tải dữ liệu miễn phí."
          }
        },
        {
          "@type": "Question",
          "name": "Làm thế nào để tải lịch sử giá vàng Việt Nam?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Tại Viet Dataverse, bạn có thể tải lịch sử giá vàng SJC, DOJI, PNJ từ 2015 hoàn toàn miễn phí. Click vào nút 'Download' trong mục Download Datasets hoặc truy cập API tại https://api.vietdataverse.online/api/v1/gold"
          }
        },
        {
          "@type": "Question",
          "name": "How to download Vietnam historical gold price data?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Download Vietnam historical gold price free at Viet Dataverse. Click 'Download' button in Download Datasets section or access API at https://api.vietdataverse.online/api/v1/gold. Data includes SJC, DOJI, PNJ prices from 2015."
          }
        },
        {
          "@type": "Question",
          "name": "Lãi suất liên ngân hàng SBV là gì?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Lãi suất liên ngân hàng SBV là lãi suất mà các ngân hàng thương mại cho vay lẫn nhau, được Ngân hàng Nhà nước Việt Nam công bố. Dữ liệu cập nhật hàng ngày tại Viet Dataverse."
          }
        },
        {
          "@type": "Question",
          "name": "Tải giá vàng ở đâu miễn phí?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Bạn có thể tải giá vàng miễn phí tại Viet Dataverse (vietdataverse.online). Dữ liệu bao gồm giá vàng SJC, DOJI, BTMC từ 2015 đến nay, hỗ trợ tải CSV và truy cập qua API."
          }
        },
        {
          "@type": "Question",
          "name": "Where can I download Vietnam gold price data for free?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "You can download Vietnam gold price data for free at Viet Dataverse (vietdataverse.online). Data includes SJC, DOJI, BTMC gold prices from 2015, available as CSV download and RESTful API."
          }
        },
        {
          "@type": "Question",
          "name": "Dữ liệu giá vàng được cập nhật bao lâu một lần?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Dữ liệu giá vàng tại Viet Dataverse được cập nhật 2 lần mỗi ngày từ các nguồn uy tín như BTMC, DOJI, PNJ. Bạn có thể tải dữ liệu mới nhất bất cứ lúc nào."
          }
        }
      ]
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Tải Giá Vàng & Dữ Liệu Kinh Tế",
          "item": "https://vietdataverse.online/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Download Gold Price Vietnam",
          "item": "https://vietdataverse.online/#data-portal"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "Download & API",
          "item": "https://vietdataverse.online/#download-api"
        }
      ]
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Viet Dataverse",
      "alternateName": ["VietDataverse", "vietdataverse", "Viet Dataverse"],
      "url": "https://vietdataverse.online/",
      "logo": {
        "@type": "ImageObject",
        "url": "https://ik.imagekit.io/o2u9hny2s/vietdataverse/icon-512.png",
        "width": 512,
        "height": 512
      },
      "description": "Nền tảng dữ liệu kinh tế Việt Nam minh bạch, cung cấp giá vàng, giá bạc, lãi suất ngân hàng và các chỉ số thị trường",
      "sameAs": [
        "https://github.com/findatasolution/vietdataverse"
      ]
    }
    </script>
    <!-- Auth0 SPA SDK -->
    <script src="https://cdn.auth0.com/js/auth0-spa-js/2.1/auth0-spa-js.production.js"></script>

    <!-- Auth module -->
    <script src="auth.js"></script>
</head>
<body>
    <!-- SEO: noscript fallback for crawlers that don't execute JavaScript -->
    <noscript>
        <div style="max-width:800px;margin:2rem auto;padding:1rem;font-family:sans-serif;">
            <h1>Tải Lịch Sử Giá Vàng Miễn Phí | Download Vietnam Gold Price CSV</h1>
            <p>Viet Dataverse cung cấp dữ liệu lịch sử giá vàng SJC, DOJI, BTMC từ 2015 hoàn toàn miễn phí. Download Vietnam gold price data CSV, giá bạc Phú Quý, lãi suất ngân hàng SBV. Cập nhật 2 lần mỗi ngày.</p>
            <h2>Dữ liệu có sẵn để tải</h2>
            <ul>
                <li><strong>Giá Vàng Trong Nước</strong> - Tải lịch sử giá vàng SJC, DOJI HN, DOJI SG, BTMC, PNJ từ 2015</li>
                <li><strong>Giá Bạc Phú Quý</strong> - Lịch sử giá bạc thỏi tại thị trường Việt Nam</li>
                <li><strong>Lãi Suất Liên Ngân Hàng SBV</strong> - Lãi suất qua đêm, 1 tuần, 1-9 tháng</li>
                <li><strong>Lãi Suất Gửi Tiết Kiệm</strong> - ACB, VCB, CTG, SHB</li>
            </ul>
            <h2>Download Gold Price Vietnam</h2>
            <p>Free API access: <a href="https://api.vietdataverse.online/api/docs">api.vietdataverse.online/api/docs</a></p>
            <p>Download gold price CSV, silver price, SBV interbank rates from 2015 to present. Updated twice daily.</p>
            <h2>Đối Tác Chứng Khoán</h2>
            <p><a href="partners.html">Mở tài khoản chứng khoán SSI, VPBank Securities miễn phí</a></p>
        </div>
    </noscript>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="brand">
                <button class="mobile-menu-btn" id="mobile-menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="brand-icon">
                    <img src="https://ik.imagekit.io/o2u9hny2s/vietdataverse/V2.png" alt="Viet Dataverse Logo">
                </div>
                <div class="brand-text">
                    <div style="font-family: 'Playfair Display', serif; font-size: 1.75rem; font-weight: 700; letter-spacing: -0.02em; background: linear-gradient(135deg, var(--gold-accent) 0%, var(--gold-primary) 100%); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 0.125rem;">Viet Dataverse</div>
                    <p class="brand-subtitle">Economic Intelligence</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="header-btn" id="lang-toggle">
                    <span id="lang-text">En/Vie</span>
                </button>

                <!-- Authenticated user info -->
                <div class="user-info" id="user-info" style="display: none;">
                    <!-- <div class="user-avatar">U</div> -->
                    <div>
                        <div id="user-email" style="font-weight: 500;"></div>
                        <!-- <div style="font-size: 0.75rem; opacity: 0.7;">Đã đăng nhập</div> -->
                    </div>
                </div>

                <!-- Login button (shown when not authenticated) -->
                <a href="#" class="header-link" id="login-link" onclick="event.preventDefault(); login();">
                    <button class="header-btn primary">
                        <span>Đăng nhập</span>
                    </button>
                </a>

                <!-- Logout button (shown when authenticated) -->
                <button class="header-btn danger" id="logout-btn" style="display: none;">
                    <span>Đăng xuất</span>
                </button>
            </div>
        </header>

        <!-- Mobile Overlay -->
        <div class="mobile-overlay" id="mobile-overlay"></div>

        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Mobile User Controls Section -->
            <div class="sidebar-section">
                <ul class="nav-list">
                    <!-- ── FREE (hooks) ── -->
                    <li class="nav-item">
                        <a class="nav-link active" data-tab="data-portal">
                            <div class="nav-content">
                                <h4>Open Economic Data</h4>
                            </div>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-tab="1smarket-portal">
                            <div class="nav-content">
                                <h4 data-i18n="nav1sMarketPortal">1s Market Pulse</h4>
                                <span class="nav-meta" data-i18n="nav1smarketsub">
                                Important updates with MRI
                                </span>
                            </div>
                        </a>
                    </li>


                    <!-- ── PROFIT (monetization) ── -->
                    <li class="nav-item nav-ai-agent">
                        <a class="nav-link" data-tab="fintel-agent-for-hire">
                            <div class="nav-content">
                                <h4 data-i18n="navfinagent">
                                    Fintel AI Agent
                                    <span class="beta-badge">BETA</span>
                                </h4>
                                <span class="nav-meta" data-i18n="navfinagentsub">
                                    AI Agents for Hire
                                </span>
                            </div>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="partners.html">
                            <div class="nav-content">
                                <h4>Đối Tác</h4>
                                <span class="nav-meta">Nhà cung cấp dịch vụ uy tín</span>
                            </div>
                        </a>
                    </li>

                </ul>
            </div>
            <div class="sidebar-section mobile-only">
                <h2 class="sidebar-heading">Account</h2>

                <!-- Language Toggle -->
                <button class="sidebar-btn" id="sidebar-lang-toggle">
                    <i class="fas fa-language"></i>
                    <span id="sidebar-lang-text">En/Vie</span>
                </button>

                <!-- User Info (shown when authenticated) -->
                <div class="sidebar-user-info" id="sidebar-user-info" style="display: none;">
                    <div class="sidebar-user-email" id="sidebar-user-email"></div>
                </div>

                <!-- Login Link (shown when not authenticated) -->
                <a href="#" class="sidebar-link" id="sidebar-login-link" onclick="event.preventDefault(); login();">
                    <button class="sidebar-btn primary">
                        <i class="fas fa-sign-in-alt"></i>
                        <span>Đăng nhập</span>
                    </button>
                </a>

                <!-- Logout Button (shown when authenticated) -->
                <button class="sidebar-btn danger" id="sidebar-logout-btn" style="display: none;">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Đăng xuất</span>
                </button>
            </div>

            <!-- About & Terms — pinned to sidebar bottom -->
            <a class="sidebar-bottom-link" data-tab="about-terms">
                <span>About & Terms</span>
            </a>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            
            <!-- Open Economic Data -->
            <div class="tab-content active" id="data-portal">
                <div class="section-header">
                    <h1 class="section-title" style="font-size: 2.5rem;">Tải Giá Vàng & Dữ Liệu Kinh Tế Mở</h1>
                    <p class="section-subtitle" style="font-size: 1.125rem;">
                        <strong>Tải lịch sử giá vàng SJC, DOJI, BTMC</strong> miễn phí từ 2015. <strong>Download Vietnam gold price CSV</strong>, giá bạc Phú Quý, lãi suất SBV.
                        API & export hoàn toàn miễn phí cho phân tích và nghiên cứu kinh tế.
                    </p>
                </div>

                <!-- Charts Section with Tabs -->
                <div class="charts-section">
                    <!-- Tab Navigation -->
                    <div class="chart-tabs">
                        <button class="chart-tab-btn active" data-tab="tab-gold-silver">
                            <i class="fas fa-coins"></i>
                            <span>Vàng & Bạc</span>
                        </button>
                        <button class="chart-tab-btn" data-tab="tab-currency">
                            <i class="fas fa-university"></i>
                            <span>Tiền tệ VN</span>
                        </button>
                        <button class="chart-tab-btn" data-tab="tab-global">
                            <i class="fas fa-globe"></i>
                            <span>Thị trường Quốc tế</span>
                        </button>
                    </div>

                    <!-- Tab 1: Vàng & Bạc (Load immediately) -->
                    <div class="tab-content active" id="tab-gold-silver">
                        <!-- Gold Price Chart -->
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3 class="chart-title">
                                    Lịch Sử Giá Vàng Việt Nam
                                </h3>
                                <div class="chart-filters">
                                    <select id="goldTypeSelect" class="type-select" style="margin-right: 10px; padding: 8px; border-radius: 4px; border: 1px solid rgba(201, 165, 91, 0.3); background: #1C1C1C; color: #A0A0A0;">
                                        <option value="DOJI HN">DOJI HN</option>
                                    </select>
                                    <button class="filter-btn" data-chart="gold" data-period="7d">7 Days</button>
                                    <button class="filter-btn active" data-chart="gold" data-period="1m">1 Month</button>
                                    <button class="filter-btn" data-chart="gold" data-period="1y">1 Year</button>
                                    <button class="filter-btn" data-chart="gold" data-period="all">All</button>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="goldChart"></canvas>
                                <div class="chart-loading" id="goldLoading">
                                    <div class="chart-skeleton">
                                        <div class="skeleton-bars">
                                            <div class="skeleton skeleton-bar" style="height: 60%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 80%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 45%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 90%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 70%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 55%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 85%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 65%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Silver Price Chart -->
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3 class="chart-title">
                                    Lịch Sử Giá Bạc Việt Nam - Phú Quý
                                </h3>
                                <div class="chart-filters">
                                    <button class="filter-btn" data-chart="silver" data-period="7d">7 Days</button>
                                    <button class="filter-btn active" data-chart="silver" data-period="1m">1 Month</button>
                                    <button class="filter-btn" data-chart="silver" data-period="1y">1 Year</button>
                                    <button class="filter-btn" data-chart="silver" data-period="all">All</button>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="silverChart"></canvas>
                                <div class="chart-loading" id="silverLoading">
                                    <div class="chart-skeleton">
                                        <div class="skeleton-bars">
                                            <div class="skeleton skeleton-bar" style="height: 70%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 50%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 85%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 60%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 75%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 55%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 90%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 65%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Gold Price Analysis -->
                        <!-- <article class="article-featured" id="article-1">
                            <div class="article-header">
                                <span class="article-tag">
                                    Phân Tích Thị Trường Vàng
                                </span>
                                <h1 class="article-title">Phân Tích Giá Vàng Hôm Nay: Xu Hướng Tăng Mạnh Theo Thị Trường Toàn Cầu</h1>
                                <div class="article-meta">
                                    <span class="meta-item">
                                        Viet Dataverse
                                    </span>
                                    <span class="meta-item">
                                        13/01/2026 • 08:00
                                    </span>
                                    <span class="meta-item">
                                        Automated Analysis by Fintel
                                    </span>
                                </div>
                            </div>
                            <div class="article-body">
                                <div class="article-text">
                                    <h3>Diễn biến thị trường vàng toàn cầu</h3>
                                    <p>
                                        Giá vàng tương lai trên sàn COMEX đạt <strong>$2,690/oz</strong>, tăng 1.2% so với phiên giao dịch trước đó, phản ánh tâm lý lo ngại về lạm phát toàn cầu và căng thẳng địa chính trị gia tăng.
                                        Chỉ số NASDAQ Composite ghi nhận mức <strong>19,630 điểm</strong>, giảm 0.8% trong tuần qua, khiến dòng vốn chuyển hướng sang tài sản trú ẩn an toàn như vàng và trái phiếu chính phủ.
                                        Giá bạc giao ngay tại thị trường quốc tế đạt <strong>$31.2/oz</strong>, tăng 2.1% theo xu hướng của vàng, cho thấy kim loại quý đang được ưa chuộng trong bối cảnh bất ổn kinh tế.
                                    </p>

                                    <h3>Thị trường vàng trong nước</h3>
                                    <p>
                                        Vàng SJC tại Hà Nội hôm nay giao dịch ở mức <strong>160.0 - 160.0 triệu đồng/lượng</strong> (mua vào - bán ra), tăng 2.2 triệu đồng (+1.4%) so với phiên trước, đạt mức cao nhất trong 3 tháng qua theo dữ liệu từ DOJI.
                                        Chênh lệch giá mua-bán thu hẹp xuống còn 0 đồng, phản ánh thanh khoản tốt và nhu cầu mua vào mạnh mẽ từ nhà đầu tư cá nhân và tổ chức.
                                        Khối lượng giao dịch vàng miếng SJC tăng 35% so với tuần trước, cho thấy dòng tiền đang đổ mạnh vào kênh đầu tư vàng vật chất khi thị trường chứng khoán biến động.
                                    </p>

                                    <h3>Dự báo tuần tới (13-19/01/2026)</h3>
                                    <p>
                                        Giá vàng trong nước dự kiến <strong>tiếp tục xu hướng tăng</strong> trong tuần tới với biên độ 1-3 triệu đồng/lượng, chạm mốc 162-163 triệu đồng, do áp lực từ giá vàng thế giới tăng mạnh và tâm lý trú ẩn an toàn tăng cao.
                                        Yếu tố chính hỗ trợ đà tăng là cuộc họp Fed ngày 29/01 sắp tới, thị trường kỳ vọng Fed sẽ giữ nguyên lãi suất ở mức 5.25-5.50%, tạo áp lực giảm lên đồng USD và đẩy giá vàng lên cao.
                                        Rủi ro điều chỉnh giảm có thể xảy ra nếu số liệu CPI tháng 1 của Mỹ (công bố 15/01) thấp hơn dự báo, làm giảm kỳ vọng lạm phát và giảm sức hấp dẫn của vàng như công cụ phòng ngừa rủi ro.
                                    </p>
                                    <p class="article-disclaimer">
                                        <em>Lưu ý: Đây là phân tích dựa trên dữ liệu lịch sử và xu hướng thị trường. Nhà đầu tư nên tham khảo ý kiến chuyên gia trước khi đưa ra quyết định đầu tư.</em>
                                    </p>
                                </div>
                            </div>
                        </article> -->

                        <!-- Download Section Gold, Silver-->
                        <div class="datasets-grid">
                            <!-- Gold Dataset -->
                            <div class="dataset-card">
                                <div class="dataset-top">
                                    <div class="dataset-info">
                                        <h3>Lịch Sử Giá Vàng Trong Nước</h3>
                                    </div>
                                </div>
                                <div class="dataset-actions">
                                    <button class="btn btn-primary" data-download="gold" title="Tải lịch sử giá vàng">
                                        <i class="fas fa-download"></i> Download
                                    </button>
                                    <button class="btn btn-secondary" data-api="gold" title="Vietnam gold price API">
                                        <i class="fas fa-code"></i> API
                                    </button>
                                </div>
                            </div>

                            <!-- Silver Dataset -->
                            <div class="dataset-card">
                                <div class="dataset-top">
                                    <div class="dataset-info">
                                        <h3>Giá Bạc Phú Quý</h3>
                                    </div>
                                </div>
                                <div class="dataset-actions">
                                    <button class="btn btn-primary" data-download="silver">
                                        <i class="fas fa-download"></i> Download
                                    </button>
                                    <button class="btn btn-secondary" data-api="silver">
                                        <i class="fas fa-code"></i> API
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tab 2: Tiền tệ VN (Lazy load) -->
                    <div class="tab-content" id="tab-currency">
                        <!-- TD Chart - Term Deposit Interest Rates -->
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3 class="chart-title">
                                    Lãi Suất Gửi Tiết Kiệm
                                </h3>
                                <div class="chart-filters">
                                    <select id="bankTypeSelect" class="type-select" style="margin-right: 10px; padding: 8px; border-radius: 4px; border: 1px solid rgba(201, 165, 91, 0.3); background: #1C1C1C; color: #A0A0A0;">
                                        <option value="ACB">ACB</option>
                                        <option value="CTG">CTG</option>
                                        <option value="SHB">SHB</option>
                                    </select>
                                    <!-- <button class="filter-btn" data-chart="td" data-period="7d">7 Days</button>
                                    <button class="filter-btn active" data-chart="td" data-period="1m">1 Month</button> -->
                                    <button class="filter-btn" data-chart="td" data-period="1y">1 Year</button>
                                    <button class="filter-btn" data-chart="td" data-period="all">All</button>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="tdChart"></canvas>
                                <div class="chart-loading" id="tdLoading">
                                    <div class="chart-skeleton">
                                        <div class="skeleton-bars">
                                            <div class="skeleton skeleton-bar" style="height: 55%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 75%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 60%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 85%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 70%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 50%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 80%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 65%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- SBV Interbank Rate Chart -->
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3 class="chart-title">
                                    Lịch Sử Lãi Suất Liên Ngân Hàng SBV
                                </h3>
                                <div class="chart-filters">
                                    <button class="filter-btn" data-chart="sbv" data-period="7d">7 Days</button>
                                    <button class="filter-btn active" data-chart="sbv" data-period="1m">1 Month</button>
                                    <button class="filter-btn" data-chart="sbv" data-period="1y">1 Year</button>
                                    <button class="filter-btn" data-chart="sbv" data-period="all">All</button>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="sbvChart"></canvas>
                                <div class="chart-loading" id="sbvLoading">
                                    <div class="chart-skeleton">
                                        <div class="skeleton-bars">
                                            <div class="skeleton skeleton-bar" style="height: 65%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 80%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 50%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 70%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 85%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 55%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 75%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 60%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        

                        <!-- Download Section Gold, Silver-->
                        <div class="datasets-grid">
                            <!-- SBV Interbank -->
                            <div class="dataset-card">
                                <div class="dataset-top">
                                    <div class="dataset-info">
                                        <h3>Lãi Suất Liên Ngân Hàng SBV</h3>
                                    </div>
                                    <button class="save-interest-btn" data-interest="sbv-data" title="Lưu quan tâm">
                                        <i class="fas fa-bookmark"></i>
                                    </button>
                                </div>
                                <p class="dataset-desc">
                                    Lãi suất liên ngân hàng chính thức được Ngân hàng Nhà nước Việt Nam (SBV) công bố, bao gồm các kỳ hạn từ overnight đến 9 tháng.
                                </p>
                                <div class="dataset-stats">
                                    <span class="stat-item">
                                        2025 - Present
                                    </span>
                                    <span class="stat-item">
                                        45+ updates
                                    </span>
                                </div>
                                <div class="dataset-actions">
                                    <button class="btn btn-primary" data-download="sbv">
                                        <i class="fas fa-download"></i> Download
                                    </button>
                                    <button class="btn btn-secondary" data-api="sbv">
                                        <i class="fas fa-code"></i> API
                                    </button>
                                </div>
                            </div>

                            <!-- Term Deposit -->
                            <div class="dataset-card disabled">
                                <div class="dataset-top">
                                    <div class="dataset-info">
                                        <h3>Bank Term Deposit Rates</h3>
                                    </div>
                                    <button class="save-interest-btn" data-interest="termdepo-data" title="Lưu quan tâm">
                                        <i class="fas fa-bookmark"></i>
                                    </button>
                                </div>
                                <p class="dataset-desc">
                                    Savings interest rates from Vietnam's 8 largest commercial banks (VCB, VTB, TCB, MB, ACB, TPB, VPB, AGR).
                                </p>
                                <div class="dataset-stats">
                                    <span class="stat-item">
                                        In Development
                                    </span>
                                    <span class="stat-item">
                                        Q1 2026
                                    </span>
                                </div>
                                <div class="dataset-actions">
                                    <button class="btn btn-primary" disabled>
                                        Coming Soon
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab 3: Thị trường Quốc tế (Lazy load) -->
                    <div class="tab-content" id="tab-global">
                        <!-- Global Macro Chart -->
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3 class="chart-title">
                                    Xu Hướng Thị Trường Toàn Cầu (Vàng, Bạc, NASDAQ)
                                </h3>
                                <div class="chart-filters">
                                    <button class="filter-btn" data-chart="global" data-period="7d">7 Days</button>
                                    <button class="filter-btn active" data-chart="global" data-period="1m">1 Month</button>
                                    <button class="filter-btn" data-chart="global" data-period="1y">1 Year</button>
                                    <button class="filter-btn" data-chart="global" data-period="all">All</button>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="globalChart"></canvas>
                                <div class="chart-loading" id="globalLoading">
                                    <div class="chart-skeleton">
                                        <div class="skeleton-bars">
                                            <div class="skeleton skeleton-bar" style="height: 75%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 55%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 90%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 65%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 80%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 50%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 70%"></div>
                                            <div class="skeleton skeleton-bar" style="height: 85%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            
            <!-- 1s Market Pulse -->
            <div class="tab-content" id="1smarket-portal">
                <div class="section-header">
                    <h1 class="section-title" style="font-size: 2.5rem;">Thời Báo 1 Giây</h1>
                    <p class="section-subtitle" style="font-size: 1.125rem;">
                        <strong>Thông tin toàn cầu ảnh hưởng đến thị trường tài chính trong nước</strong>
                    </p>
                </div>

                <!-- Filters -->
                <div id="pulse-filters" style="display:flex;flex-wrap:wrap;gap:0.75rem;margin-bottom:1.5rem;padding:1rem;background:var(--bg-secondary);border-radius:8px;">
                    <div style="display:flex;align-items:center;gap:0.5rem;">
                        <label style="font-size:0.85rem;color:var(--text-secondary);">Nguon:</label>
                        <select id="filter-source" style="padding:6px 12px;border-radius:6px;border:1px solid var(--border-color);background:var(--bg-primary);color:var(--text-primary);font-size:0.85rem;">
                            <option value="">Tat ca</option>
                            <option value="CNBC">CNBC</option>
                            <option value="BBC">BBC</option>
                            <option value="MarketWatch">MarketWatch</option>
                        </select>
                    </div>
                    <div style="display:flex;align-items:center;gap:0.5rem;">
                        <label style="font-size:0.85rem;color:var(--text-secondary);">Thi truong:</label>
                        <select id="filter-label" style="padding:6px 12px;border-radius:6px;border:1px solid var(--border-color);background:var(--bg-primary);color:var(--text-primary);font-size:0.85rem;">
                            <option value="">Tat ca</option>
                            <option value="VNINDEX">VN-Index</option>
                            <option value="GOLD">Vang</option>
                            <option value="REAL_ESTATE">Bat dong san</option>
                            <option value="BANKING">Ngan hang</option>
                            <option value="FX">Ngoai hoi</option>
                        </select>
                    </div>
                    <div style="display:flex;align-items:center;gap:0.5rem;">
                        <label style="font-size:0.85rem;color:var(--text-secondary);">MRI:</label>
                        <select id="filter-mri" style="padding:6px 12px;border-radius:6px;border:1px solid var(--border-color);background:var(--bg-primary);color:var(--text-primary);font-size:0.85rem;">
                            <option value="">Tat ca</option>
                            <option value="positive">Tich cuc (+)</option>
                            <option value="negative">Tieu cuc (-)</option>
                        </select>
                    </div>
                    <button id="filter-reset" style="padding:6px 12px;border-radius:6px;border:1px solid var(--border-color);background:transparent;color:var(--text-secondary);font-size:0.85rem;cursor:pointer;">Reset</button>
                </div>

                <div id="market-pulse-articles">
                    <!-- Skeleton loading -->
                    <div class="pulse-skeleton" style="animation:pulse 1.5s infinite;">
                        <div style="background:var(--bg-secondary);border-radius:12px;padding:1.5rem;margin-bottom:1rem;">
                            <div style="height:20px;width:80px;background:var(--border-color);border-radius:4px;margin-bottom:0.75rem;"></div>
                            <div style="height:28px;width:70%;background:var(--border-color);border-radius:4px;margin-bottom:0.5rem;"></div>
                            <div style="height:16px;width:40%;background:var(--border-color);border-radius:4px;margin-bottom:1rem;"></div>
                            <div style="height:60px;width:100%;background:var(--border-color);border-radius:4px;"></div>
                        </div>
                        <div style="background:var(--bg-secondary);border-radius:12px;padding:1.5rem;margin-bottom:1rem;">
                            <div style="height:20px;width:80px;background:var(--border-color);border-radius:4px;margin-bottom:0.75rem;"></div>
                            <div style="height:28px;width:60%;background:var(--border-color);border-radius:4px;margin-bottom:0.5rem;"></div>
                            <div style="height:16px;width:35%;background:var(--border-color);border-radius:4px;margin-bottom:1rem;"></div>
                            <div style="height:60px;width:100%;background:var(--border-color);border-radius:4px;"></div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Fintel Agent -->
            <div class="tab-content" id="fintel-agent-for-hire">
                <!-- Hero Section -->
                <div class="fintel-hero">
                    <div class="fintel-hero-badge">
                        <i class="fas fa-sparkles"></i>
                        <span data-i18n="fintelHeroBadge">Powered by Advanced AI</span>
                    </div>
                    <h1 class="fintel-hero-title" data-i18n="fintelHeroTitle">Fintel AI Agents</h1>
                    <p class="fintel-hero-subtitle" data-i18n="fintelHeroSubtitle">
                        AI Agents chuyên biệt cho phân tích tài chính, dự báo thị trường, và tự động hóa giao dịch.
                        Tích hợp dễ dàng qua API, nhận cảnh báo real-time qua webhook.
                    </p>
                </div>

                <!-- Agents Grid -->
                <div class="agents-grid">
                    <!-- Market Analysis Agent -->
                    <div class="agent-card">
                        <div class="agent-card-icon purple">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="agent-card-header">
                            <div>
                                <h3 class="agent-card-title" data-i18n="agentMarketTitle">Market Analysis Agent</h3>
                            </div>
                            <span class="agent-card-status coming-soon" data-i18n="agentStatusComingSoon">Coming Soon</span>
                        </div>
                        <p class="agent-card-desc" data-i18n="agentMarketDesc">
                            Phân tích thị trường tự động - Theo dõi VN-Index, phân tích kỹ thuật, nhận diện xu hướng và cảnh báo biến động bất thường 24/7.
                        </p>
                        <div class="agent-card-features">
                            <span class="agent-feature-tag">Technical Analysis</span>
                            <span class="agent-feature-tag">Trend Detection</span>
                            <span class="agent-feature-tag">Alert System</span>
                        </div>
                        <div class="agent-card-footer">
                            <span class="agent-card-meta"><i class="fas fa-chart-area"></i> VN-Index, VN30</span>
                            <span class="agent-card-meta"><i class="fas fa-bolt"></i> Real-time</span>
                            <button class="save-interest-btn" data-interest="agent-market-analysis" title="Lưu quan tâm" style="margin-left: auto;">
                                <i class="fas fa-bookmark"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Gold Trading Agent -->
                    <div class="agent-card">
                        <div class="agent-card-icon amber">
                            <i class="fas fa-coins"></i>
                        </div>
                        <div class="agent-card-header">
                            <div>
                                <h3 class="agent-card-title" data-i18n="agentGoldTitle">Gold Trading Agent</h3>
                            </div>
                            <span class="agent-card-status coming-soon" data-i18n="agentStatusComingSoon">Coming Soon</span>
                        </div>
                        <p class="agent-card-desc" data-i18n="agentGoldDesc">
                            Theo dõi giá vàng - So sánh giá vàng SJC, DOJI, PNJ với giá quốc tế, cảnh báo chênh lệch và thời điểm mua/bán tối ưu.
                        </p>
                        <div class="agent-card-features">
                            <span class="agent-feature-tag">Price Arbitrage</span>
                            <span class="agent-feature-tag">Buy/Sell Signals</span>
                            <span class="agent-feature-tag">Spread Analysis</span>
                        </div>
                        <div class="agent-card-footer">
                            <span class="agent-card-meta"><i class="fas fa-coins"></i> SJC, DOJI, PNJ</span>
                            <span class="agent-card-meta"><i class="fas fa-globe"></i> XAU/USD</span>
                            <button class="save-interest-btn" data-interest="agent-gold-trading" title="Lưu quan tâm" style="margin-left: auto;">
                                <i class="fas fa-bookmark"></i>
                            </button>
                        </div>
                    </div>

                    <!-- News Sentiment Agent -->
                    <div class="agent-card">
                        <div class="agent-card-icon blue">
                            <i class="fas fa-newspaper"></i>
                        </div>
                        <div class="agent-card-header">
                            <div>
                                <h3 class="agent-card-title" data-i18n="agentNewsTitle">News Sentiment Agent</h3>
                            </div>
                            <span class="agent-card-status coming-soon" data-i18n="agentStatusComingSoon">Coming Soon</span>
                        </div>
                        <p class="agent-card-desc" data-i18n="agentNewsDesc">
                            Phân tích tin tức - Quét tin tức tài chính 24/7, đánh giá sentiment và dự báo tác động đến thị trường VN bằng AI.
                        </p>
                        <div class="agent-card-features">
                            <span class="agent-feature-tag">Multi-source</span>
                            <span class="agent-feature-tag">MRI Score</span>
                            <span class="agent-feature-tag">Impact Prediction</span>
                        </div>
                        <div class="agent-card-footer">
                            <span class="agent-card-meta"><i class="fas fa-rss"></i> 50+ Sources</span>
                            <span class="agent-card-meta"><i class="fas fa-brain"></i> NLP/LLM</span>
                            <button class="save-interest-btn" data-interest="agent-news-sentiment" title="Lưu quan tâm" style="margin-left: auto;">
                                <i class="fas fa-bookmark"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Custom Agent -->
                    <div class="agent-card custom-card">
                        <div class="agent-card-icon green">
                            <i class="fas fa-wand-magic-sparkles"></i>
                        </div>
                        <div class="agent-card-header">
                            <div>
                                <h3 class="agent-card-title" data-i18n="agentCustomTitle">Custom Agent</h3>
                            </div>
                            <span class="agent-card-status on-request" data-i18n="agentStatusOnRequest">On Request</span>
                        </div>
                        <p class="agent-card-desc" data-i18n="agentCustomDesc">
                            Agent tùy chỉnh - Xây dựng AI agent theo yêu cầu riêng của doanh nghiệp: tích hợp dữ liệu nội bộ, workflow tự động, báo cáo định kỳ.
                        </p>
                        <div class="agent-card-features">
                            <span class="agent-feature-tag">Private Data</span>
                            <span class="agent-feature-tag">Custom Workflow</span>
                            <span class="agent-feature-tag">Enterprise</span>
                        </div>
                        <div class="agent-card-footer">
                            <span class="agent-card-meta"><i class="fas fa-cogs"></i> Custom Logic</span>
                            <span class="agent-card-meta"><i class="fas fa-plug"></i> API Integration</span>
                            <button class="save-interest-btn" data-interest="agent-custom" title="Lưu quan tâm" style="margin-left: auto;">
                                <i class="fas fa-bookmark"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Pricing Section -->
                <div class="section-header" style="margin-top: 64px;">
                    <h2 class="section-title" style="font-size: 2rem;" data-i18n="pricingTitle">Pricing Plans</h2>
                    <p class="section-subtitle" data-i18n="pricingSubtitle">Chọn gói phù hợp với nhu cầu của bạn</p>
                </div>
                <div class="pricing-grid">
                    <!-- Free Plan -->
                    <div class="pricing-card">
                        <p class="pricing-card-name" data-i18n="pricingStarter">Starter</p>
                        <p class="pricing-card-price" data-i18n="pricingFree">Free</p>
                        <ul class="pricing-card-features">
                            <li data-i18n="pricingFeature1Agent">1 Agent access</li>
                            <li data-i18n="pricingFeature1kCalls">1,000 API calls/month</li>
                            <li data-i18n="pricingFeatureEmail">Email alerts</li>
                            <li data-i18n="pricingFeatureCommunity">Community support</li>
                        </ul>
                        <button class="pricing-btn secondary" data-i18n="pricingBtnStart">Get Started</button>
                    </div>

                    <!-- Pro Plan -->
                    <div class="pricing-card featured">
                        <p class="pricing-card-name" data-i18n="pricingPro">Pro</p>
                        <p class="pricing-card-price">$9.9<span>/month</span></p>
                        <ul class="pricing-card-features">
                            <li data-i18n="pricingFeature3Agents">All 3 Agents</li>
                            <li data-i18n="pricingFeatureUnlimited">Unlimited API calls</li>
                            <li data-i18n="pricingFeatureWebhook">Real-time webhooks</li>
                            <li data-i18n="pricingFeaturePriority">Priority support</li>
                            <li data-i18n="pricingFeatureCustomAlerts">Custom alerts</li>
                        </ul>
                        <button class="pricing-btn primary" data-i18n="pricingBtnUpgrade">Upgrade to Pro</button>
                    </div>

                    <!-- Enterprise Plan -->
                    <div class="pricing-card">
                        <p class="pricing-card-name" data-i18n="pricingEnterprise">Enterprise</p>
                        <p class="pricing-card-price" data-i18n="pricingCustom">Custom</p>
                        <ul class="pricing-card-features">
                            <li data-i18n="pricingFeatureCustomAgents">Custom Agents</li>
                            <li data-i18n="pricingFeatureOnPremise">On-premise deployment</li>
                            <li data-i18n="pricingFeatureSLA">SLA guarantee</li>
                            <li data-i18n="pricingFeatureDedicated">Dedicated support</li>
                            <li data-i18n="pricingFeaturePrivate">Private data integration</li>
                        </ul>
                        <button class="pricing-btn secondary" data-i18n="pricingBtnContact">Contact Sales</button>
                    </div>
                </div>
            </div> 

            <!-- About & Terms Tab -->
            <div class="tab-content" id="about-terms">
                <div class="section-header">
                    <h1 class="section-title">About & Terms</h1>
                    <p class="section-subtitle">Về Viet Dataverse, Nguồn Dữ Liệu & Điều Khoản Sử Dụng</p>
                </div>

                <!-- Về Viet Dataverse -->
                <div style="background: rgba(0, 0, 0, 0.3); border-radius: 8px; border: 1px solid rgba(201, 165, 91, 0.2); padding: 2rem; margin: 2rem 0;">
                    <h2 style="color: var(--gold-accent); font-size: 1.5rem; margin-bottom: 1rem;">Về Viet Dataverse</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        <strong>Viet Dataverse</strong> là nền tảng dữ liệu kinh tế Việt Nam miễn phí, cung cấp thông tin <strong>giá vàng</strong>,
                        <strong>giá bạc</strong>, và <strong>lãi suất ngân hàng</strong> được thu thập tự động từ các nguồn công khai uy tín.
                    </p>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        <strong>Giá vàng trong nước</strong> (SJC, DOJI) với dữ liệu lịch sử từ năm 2015 đến nay.
                        <strong>Giá bạc trong nước</strong> (Phú Quý) được cập nhật 2 lần mỗi ngày.
                        <strong>Lãi suất liên ngân hàng</strong> do Ngân hàng Nhà nước Việt Nam (SBV) công bố.
                        <strong>Lãi suất gửi tiết kiệm</strong> từ các ngân hàng thương mại lớn.
                    </p>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        Dữ liệu được <strong>làm sạch, chuẩn hóa</strong> và lưu trữ lịch sử dài hạn để phục vụ <strong>mục đích nghiên cứu và phân tích</strong>.
                        Bạn có thể tải dữ liệu hoàn toàn miễn phí hoặc truy cập qua <strong>API</strong>.
                    </p>
                    <p style="color: #888; font-size: 0.9em; border-top: 1px solid rgba(201, 165, 91, 0.2); padding-top: 1rem; margin-top: 1rem;">
                        <strong>Lưu ý quan trọng:</strong> Dữ liệu chỉ mang tính chất tham khảo, không phải lời khuyên đầu tư.
                        Viet Dataverse không chịu trách nhiệm về các quyết định tài chính dựa trên dữ liệu này.
                        Người dùng cần tự kiểm tra và chịu trách nhiệm với quyết định của mình.
                    </p>

                </div>

                <!-- Về Nguồn Dữ Liệu & Phương Pháp Thu Thập -->
                <div style="background: rgba(0, 0, 0, 0.3); border-radius: 8px; border: 1px solid rgba(201, 165, 91, 0.2); padding: 2rem; margin: 2rem 0;">
                    <h2 style="color: var(--gold-accent); font-size: 1.5rem; margin-bottom: 1rem;">Về Nguồn Dữ Liệu & Phương Pháp Thu Thập</h2>
                    <p style="color: #A0A0A0; line-height: 1.8; margin-bottom: 1rem; font-size: 0.95rem;">
                        Dữ liệu trên Viet Dataverse được thu thập tự động từ <strong>các nguồn công khai, miễn phí</strong> bao gồm website của các tổ chức tài chính, công ty vàng bạc uy tín, và cơ quan nhà nước.
                        Tất cả dữ liệu đều là <strong>thông tin công khai</strong> mà bất kỳ ai cũng có thể truy cập.
                    </p>
                    <p style="color: #A0A0A0; line-height: 1.8; margin-bottom: 1rem; font-size: 0.95rem;">
                        Giá trị gia tăng của Viet Dataverse nằm ở việc <strong>làm sạch, chuẩn hóa, lưu trữ lịch sử dài hạn</strong> và cung cấp API miễn phí để phục vụ cộng đồng nghiên cứu.
                        Chúng tôi không sở hữu dữ liệu gốc, chỉ cung cấp dịch vụ tổng hợp và phân phối.
                    </p>
                </div>

                <!-- Điều Khoản Sử Dụng -->
                <div style="background: rgba(0, 0, 0, 0.3); border-radius: 8px; border: 1px solid rgba(201, 165, 91, 0.2); padding: 2rem; margin: 2rem 0;">
                    <h2 style="color: var(--gold-accent); font-size: 1.5rem; margin-bottom: 1rem;">Điều Khoản Sử Dụng</h2>
                    <ul style="color: #A0A0A0; line-height: 2; font-size: 0.95rem; padding-left: 1.5rem;">
                        <li><strong>Mục đích:</strong> Dữ liệu chỉ phục vụ mục đích nghiên cứu, học thuật, và phân tích cá nhân. Không dùng cho mục đích thương mại trừ khi có thỏa thuận.</li>
                        <li><strong>Không phải lời khuyên tài chính:</strong> Viet Dataverse không cung cấp lời khuyên đầu tư. Mọi quyết định tài chính là trách nhiệm của người dùng.</li>
                        <li><strong>Độ chính xác:</strong> Chúng tôi nỗ lực đảm bảo độ chính xác nhưng không chịu trách nhiệm về sai sót từ nguồn gốc hoặc quá trình thu thập.</li>
                        <li><strong>Bảo vệ nguồn:</strong> Người dùng cam kết không crawl ngược lại dữ liệu từ Viet Dataverse để tạo dịch vụ cạnh tranh.</li>
                    </ul>

                    <p style="color: #666; font-size: 0.85rem; margin-top: 1.5rem; font-style: italic;">
                        © 2026 Viet Dataverse. Nền tảng dữ liệu kinh tế Việt Nam mã nguồn mở.
                        <a href="mailto:contact@vietdataverse.online" style="color: var(--gold-primary); text-decoration: none;">Liên hệ</a>
                    </p>
                </div>
            </div>
        </main>
    </div>

    <!-- Notification Overlay (Download) -->
    <div class="notification-overlay" id="notification-overlay">
        <div class="notification-card">
            <div class="notification-icon">
                <i class="fas fa-lock"></i>
            </div>
            <h3 class="notification-title">Yêu cầu đăng nhập</h3>
            <p class="notification-message">
                Bạn cần đăng nhập để tải dữ liệu. Vui lòng đăng nhập để tiếp tục sử dụng các tính năng của Viet Dataverse.
            </p>
            <div class="notification-actions">
                <button class="notification-btn secondary" id="cancel-btn">
                    <span>Hủy</span>
                </button>
                <button class="notification-btn primary" id="login-btn">
                    <span>Đăng nhập</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Overlay (API) -->
    <div class="notification-overlay" id="api-notification-overlay">
        <div class="notification-card">
            <div class="notification-icon">
                <i class="fas fa-code"></i>
            </div>
            <h3 class="notification-title">API đang phát triển</h3>
            <p class="notification-message" id="api-message">
                Tính năng API access hiện đang trong giai đoạn phát triển. Tạo tài khoản để nhận thông báo ngay khi tính năng sẵn sàng.
            </p>
            <p class="notification-message" id="api-message-logged-in" style="display: none;">
                Tính năng API access hiện đang trong giai đoạn phát triển. Bạn sẽ nhận được thông báo qua email khi tính năng sẵn sàng.
            </p>
            <div class="notification-actions">
                <button class="notification-btn secondary" id="api-cancel-btn">
                    <span>Đóng</span>
                </button>
                <button class="notification-btn primary" id="api-signup-btn">
                    <span>Tạo tài khoản</span>
                </button>
            </div>
        </div>
    </div>

   <script>
       // Language toggle with translations (Vietnamese is primary)
        let currentLang = 'vi';

        const translations = {
            vi: {
                langBtn: 'En',
                subtitle: 'Thông tin Kinh tế',
                navDataPortal: 'Dữ Liệu Kinh Tế Mở',
                nav1sMarketPortal: 'Thời báo 1 giây',
                nav1smarketsub: 'Tờ báo quan trọng theo MRI',
                navfinagent: 'Fintel AI Agent',
                navfinagentsub: 'AI Agents cho thuê',
                navDownloadApi: 'Download & API',
                navDownloadApiMeta: 'Tải dữ liệu & API access',
                navAboutTerms: 'Giới thiệu Viet Dataverse',
                navAboutTermsMeta: 'Về dự án & Điều khoản',
                navPartners: 'Đối Tác',
                navPartnersMeta: 'Nhà cung cấp dịch vụ uy tín',
                navSeparator: 'Dịch vụ',
                mainTitle: 'Tải Giá Vàng & Dữ Liệu Kinh Tế Mở',
                mainSubtitle: '<strong>Tải lịch sử giá vàng SJC, DOJI, BTMC</strong> miễn phí từ 2015. <strong>Download Vietnam gold price CSV</strong>, giá bạc Phú Quý, lãi suất SBV. API & export hoàn toàn miễn phí cho phân tích và nghiên cứu kinh tế.',
                sectionTitle: 'Tải Giá Vàng & Dữ Liệu Kinh Tế Mở',
                sectionSubtitle: 'Bộ dữ liệu kinh tế vĩ mô Việt Nam chất lượng cao công khai và truy cập miễn phí cho mục đích nghiên cứu. Chi tiết về schemas và parameters tại',
                goldChart: 'Lịch Sử Giá Vàng Trong Nước',
                silverChart: 'Lịch Sử Giá Bạc (Phú Quý)',
                sbvChart: 'Lịch Sử Lãi Suất Liên Ngân Hàng',
                tdChart: 'Lịch Sử Lãi Suất Gửi Tiết Kiệm (NHTM)',
                globalChart: 'Xu Hướng Thị Trường Toàn Cầu (Vàng, Bạc, NASDAQ)',
                downloadTitle: 'Tải Dữ liệu Lịch Sử',
                downloadSubtitle: 'Tải dữ liệu lịch sử giá vàng trong nước, giá bạc, và dữ liệu vĩ mô tại đây',
                goldDatasetTitle: 'Tải Lịch Sử Giá Vàng',
                goldDatasetDesc: 'Tải lịch sử giá vàng trong nước. Download Vietnam historical gold price miễn phí với giá mua/bán cập nhật 2 lần mỗi ngày từ nguồn uy tín.',
                silverDatasetTitle: 'Giá Bạc Phú Quý',
                silverDatasetDesc: 'Giá Bạc tại thị trường Hà Nội (Phú Quý), dữ liệu lịch sử từ 2015. Cập nhật hàng ngày giá mua và bán từ nhà phân phối bạc uy tín.',
                sbvDatasetTitle: 'Lãi Suất Liên Ngân Hàng SBV',
                sbvDatasetDesc: 'Lãi suất liên ngân hàng VND (qua đêm, 1 tuần, 2 tuần, 1-9 tháng) công bố bởi Ngân hàng Nhà nước Việt Nam.',
                tdDatasetTitle: 'Lãi Suất Gửi Tiết Kiệm',
                apiBtn: 'Đăng nhập',
                // Fintel Agent Tab
                fintelHeroBadge: 'Được hỗ trợ bởi AI tiên tiến',
                fintelHeroTitle: 'Fintel AI Agents',
                fintelHeroSubtitle: 'AI Agents chuyên biệt cho phân tích tài chính, dự báo thị trường, và tự động hóa giao dịch. Tích hợp dễ dàng qua API, nhận cảnh báo real-time qua webhook.',
                agentMarketTitle: 'Market Analysis Agent',
                agentMarketDesc: 'Phân tích thị trường tự động - Theo dõi VN-Index, phân tích kỹ thuật, nhận diện xu hướng và cảnh báo biến động bất thường 24/7.',
                agentGoldTitle: 'Gold Trading Agent',
                agentGoldDesc: 'Theo dõi giá vàng - So sánh giá vàng SJC, DOJI, PNJ với giá quốc tế, cảnh báo chênh lệch và thời điểm mua/bán tối ưu.',
                agentNewsTitle: 'News Sentiment Agent',
                agentNewsDesc: 'Phân tích tin tức - Quét tin tức tài chính 24/7, đánh giá sentiment và dự báo tác động đến thị trường VN bằng AI.',
                agentCustomTitle: 'Custom Agent',
                agentCustomDesc: 'Agent tùy chỉnh - Xây dựng AI agent theo yêu cầu riêng của doanh nghiệp: tích hợp dữ liệu nội bộ, workflow tự động, báo cáo định kỳ.',
                agentStatusComingSoon: 'Sắp ra mắt',
                agentStatusOnRequest: 'Theo yêu cầu',
                pricingTitle: 'Bảng Giá',
                pricingSubtitle: 'Chọn gói phù hợp với nhu cầu của bạn',
                pricingStarter: 'Khởi đầu',
                pricingPro: 'Chuyên nghiệp',
                pricingEnterprise: 'Doanh nghiệp',
                pricingFree: 'Miễn phí',
                pricingCustom: 'Liên hệ',
                pricingFeature1Agent: '1 Agent truy cập',
                pricingFeature3Agents: 'Tất cả 3 Agents',
                pricingFeatureCustomAgents: 'Agents tùy chỉnh',
                pricingFeature1kCalls: '1,000 lượt gọi API/tháng',
                pricingFeatureUnlimited: 'Không giới hạn API',
                pricingFeatureEmail: 'Cảnh báo qua email',
                pricingFeatureWebhook: 'Webhooks real-time',
                pricingFeatureCommunity: 'Hỗ trợ cộng đồng',
                pricingFeaturePriority: 'Hỗ trợ ưu tiên',
                pricingFeatureCustomAlerts: 'Cảnh báo tùy chỉnh',
                pricingFeatureOnPremise: 'Triển khai nội bộ',
                pricingFeatureSLA: 'Cam kết SLA',
                pricingFeatureDedicated: 'Hỗ trợ riêng',
                pricingFeaturePrivate: 'Tích hợp dữ liệu riêng',
                pricingBtnStart: 'Bắt đầu',
                pricingBtnUpgrade: 'Nâng cấp Pro',
                pricingBtnContact: 'Liên hệ Sales'
            },
            en: {
                langBtn: 'Vie',
                subtitle: 'Economic Intelligence',
                navDataPortal: 'Open Economic Data',
                nav1sMarketPortal: '1s Market Pulse',
                nav1smarketsub: 'Important updates with Market Response Index',
                navfinagent: 'Fintel AI Agent',
                navfinagentsub: 'AI Agents for Hire',
                navDownloadApi: 'Download & API',
                navDownloadApiMeta: 'Free Download & API',
                navAboutTerms: 'About & Terms',
                navAboutTermsMeta: 'About project & Terms',
                navPartners: 'Partners',
                navPartnersMeta: 'Trusted service providers',
                navSeparator: 'Services',
                mainTitle: 'Download Gold Price & Open Economic Data',
                mainSubtitle: '<strong>Download Vietnam gold price CSV</strong> (SJC, DOJI, BTMC) from 2015 for free. Access silver prices, SBV interest rates updated twice daily. Free API & CSV export for economic research and analysis.',
                sectionTitle: 'Download Gold Price & Open Economic Data',
                sectionSubtitle: 'Transparent, high-quality Vietnamese macroeconomic datasets for research and analysis. All data sources are publicly documented and freely accessible. More details about parameters with',
                goldChart: 'Gold Price History (Vietnam)',
                silverChart: 'Silver Price History (Vietnam)',
                sbvChart: 'SBV Interbank Rates History',
                tdChart: 'Commercial Banks Term Deposit History',
                globalChart: 'Global Market Trends (Gold, Silver, NASDAQ)',
                downloadTitle: 'Download Vietnam Historical Index',
                downloadSubtitle: 'Download historical gold price data (SJC, DOJI, PNJ), silver prices, bank interest rates for free. Access Vietnam gold price data from 2015 onwards via RESTful API.',
                goldDatasetTitle: 'Vietnam Historical Gold Price',
                goldDatasetDesc: 'Download Vietnam historical gold price data (SJC, DOJI, PNJ 24K) from 2015 to present for free. Buy/sell prices updated twice daily from reliable sources.',
                silverDatasetTitle: 'Silver Price (Phu Quy)',
                silverDatasetDesc: 'Spot silver prices (Phu Quy), historical data from 2015. Daily buy/sell prices from trusted silver distributors.',
                sbvDatasetTitle: 'SBV Interbank Rates',
                sbvDatasetDesc: 'VND interbank interest rates (overnight, 1 week, 2 weeks, 1-9 months) published by State Bank of Vietnam.',
                tdDatasetTitle: 'Term Deposit Rates',
                apiBtn: 'Login',
                // Fintel Agent Tab
                fintelHeroBadge: 'Powered by Advanced AI',
                fintelHeroTitle: 'Fintel AI Agents',
                fintelHeroSubtitle: 'Specialized AI Agents for financial analysis, market forecasting, and trade automation. Easy API integration, real-time alerts via webhook.',
                agentMarketTitle: 'Market Analysis Agent',
                agentMarketDesc: 'Automated market analysis - Track VN-Index, technical analysis, trend detection and abnormal volatility alerts 24/7.',
                agentGoldTitle: 'Gold Trading Agent',
                agentGoldDesc: 'Gold price tracking - Compare SJC, DOJI, PNJ prices with international rates, spread alerts and optimal buy/sell timing.',
                agentNewsTitle: 'News Sentiment Agent',
                agentNewsDesc: 'News analysis - Scan financial news 24/7, evaluate sentiment and predict market impact on Vietnam markets using AI.',
                agentCustomTitle: 'Custom Agent',
                agentCustomDesc: 'Custom agent - Build AI agents tailored to your business: private data integration, automated workflows, scheduled reports.',
                agentStatusComingSoon: 'Coming Soon',
                agentStatusOnRequest: 'On Request',
                pricingTitle: 'Pricing Plans',
                pricingSubtitle: 'Choose the plan that fits your needs',
                pricingStarter: 'Starter',
                pricingPro: 'Pro',
                pricingEnterprise: 'Enterprise',
                pricingFree: 'Free',
                pricingCustom: 'Custom',
                pricingFeature1Agent: '1 Agent access',
                pricingFeature3Agents: 'All 3 Agents',
                pricingFeatureCustomAgents: 'Custom Agents',
                pricingFeature1kCalls: '1,000 API calls/month',
                pricingFeatureUnlimited: 'Unlimited API calls',
                pricingFeatureEmail: 'Email alerts',
                pricingFeatureWebhook: 'Real-time webhooks',
                pricingFeatureCommunity: 'Community support',
                pricingFeaturePriority: 'Priority support',
                pricingFeatureCustomAlerts: 'Custom alerts',
                pricingFeatureOnPremise: 'On-premise deployment',
                pricingFeatureSLA: 'SLA guarantee',
                pricingFeatureDedicated: 'Dedicated support',
                pricingFeaturePrivate: 'Private data integration',
                pricingBtnStart: 'Get Started',
                pricingBtnUpgrade: 'Upgrade to Pro',
                pricingBtnContact: 'Contact Sales'
            }
        };

        function updateLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];

            // Update button - Header
            document.getElementById('lang-text').textContent = t.langBtn;

            // Update button - Sidebar
            const sidebarLangText = document.getElementById('sidebar-lang-text');
            if (sidebarLangText) {
                sidebarLangText.textContent = t.langBtn;
            }
            document.querySelector('.brand-subtitle').textContent = t.subtitle;

            // Update navigation
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                if (link.getAttribute('data-tab') === 'data-portal') {
                    link.querySelector('h4').textContent = t.navDataPortal;
                } else if (link.getAttribute('data-tab') === '1smarket-portal') {
                    link.querySelector('h4').textContent = t.nav1sMarketPortal;
                    const meta = link.querySelector('.nav-meta');
                    if (meta) meta.textContent = t.nav1smarketsub;
                } else if (link.getAttribute('data-tab') === 'fintel-agent-for-hire') {
                    link.querySelector('h4').innerHTML = t.navfinagent + ' <span class="beta-badge">BETA</span>';
                    const meta = link.querySelector('.nav-meta');
                    if (meta) meta.textContent = t.navfinagentsub;
                } else if (link.getAttribute('data-tab') === 'download-api') {
                    link.querySelector('h4').textContent = t.navDownloadApi;
                    const meta = link.querySelector('.nav-meta');
                    if (meta) meta.textContent = t.navDownloadApiMeta;
                } else if (link.getAttribute('href') === 'partners.html') {
                    link.querySelector('h4').textContent = t.navPartners;
                    const meta = link.querySelector('.nav-meta');
                    if (meta) meta.textContent = t.navPartnersMeta;
                }
            });

            // Update separator label
            const sep = document.querySelector('.nav-separator span');
            if (sep) sep.textContent = t.navSeparator;

            // Update sidebar bottom link
            const btmLink = document.querySelector('.sidebar-bottom-link span');
            if (btmLink) btmLink.textContent = t.navAboutTerms;

            // Update main title & subtitle (SEO optimized)
            const mainSection = document.querySelector('#data-portal .section-header');
            if (mainSection) {
                const mainTitle = mainSection.querySelector('.section-title');
                const mainSubtitle = mainSection.querySelector('.section-subtitle');
                if (mainTitle) mainTitle.textContent = t.mainTitle;
                if (mainSubtitle) {
                    // Remove <strong> tags and set text content
                    mainSubtitle.innerHTML = t.mainSubtitle;
                }
            }

            // Update download section
            const downloadSection = document.querySelector('#download-api .section-header');
            if (downloadSection) {
                const dlTitle = downloadSection.querySelector('.section-title');
                const dlSubtitle = downloadSection.querySelector('.section-subtitle');
                if (dlTitle) dlTitle.textContent = t.downloadTitle;
                if (dlSubtitle) dlSubtitle.innerHTML = t.downloadSubtitle;
            }

            // Update dataset cards (only in Download tab, not Fintel Agent tab)
            const datasetCards = document.querySelectorAll('#download-api .dataset-card');
            if (datasetCards[0]) {
                const h3 = datasetCards[0].querySelector('h3');
                const desc = datasetCards[0].querySelector('.dataset-desc');
                if (h3) h3.textContent = t.goldDatasetTitle;
                if (desc) desc.innerHTML = t.goldDatasetDesc;
            }
            if (datasetCards[1]) {
                const h3 = datasetCards[1].querySelector('h3');
                const desc = datasetCards[1].querySelector('.dataset-desc');
                if (h3) h3.textContent = t.silverDatasetTitle;
                if (desc) desc.innerHTML = t.silverDatasetDesc;
            }
            if (datasetCards[2]) {
                const h3 = datasetCards[2].querySelector('h3');
                const desc = datasetCards[2].querySelector('.dataset-desc');
                if (h3) h3.textContent = t.sbvDatasetTitle;
                if (desc) desc.innerHTML = t.sbvDatasetDesc;
            }
            if (datasetCards[3]) {
                const h3 = datasetCards[3].querySelector('h3');
                const desc = datasetCards[3].querySelector('.dataset-desc');
                if (h3) h3.textContent = t.tdDatasetTitle;
                if (desc) desc.innerHTML = t.tdDatasetDesc;
            }

            // Update charts
            const chartTitles = document.querySelectorAll('.chart-title');
            if (chartTitles[0]) chartTitles[0].textContent = t.goldChart;
            if (chartTitles[1]) chartTitles[1].textContent = t.silverChart;
            if (chartTitles[2]) chartTitles[2].textContent = t.tdChart;
            if (chartTitles[3]) chartTitles[3].textContent = t.sbvChart;
            if (chartTitles[4]) chartTitles[4].textContent = t.globalChart;

            // Update Fintel Agent tab
            const fintelTab = document.getElementById('fintel-agent-for-hire');
            if (fintelTab) {
                fintelTab.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (t[key]) el.textContent = t[key];
                });
            }

            // Update API button
            document.querySelector('.header-btn.primary span').textContent = t.apiBtn;

            // Set HTML lang and visual feedback
            document.documentElement.lang = lang;
            document.getElementById('lang-toggle').style.borderColor =
                lang === 'vi' ? 'var(--gold-primary)' : 'var(--silver)';
        }

        // Check authentication status and update UI
        function checkAuthenticationStatus() {
            const token = localStorage.getItem('auth_token');
            const userEmail = localStorage.getItem('user_email');

            const userInfo = document.getElementById('user-info');
            const loginLink = document.getElementById('login-link');
            const logoutBtn = document.getElementById('logout-btn');
            const userEmailElement = document.getElementById('user-email');

            // Sidebar elements
            const sidebarUserInfo = document.getElementById('sidebar-user-info');
            const sidebarLoginLink = document.getElementById('sidebar-login-link');
            const sidebarLogoutBtn = document.getElementById('sidebar-logout-btn');
            const sidebarUserEmail = document.getElementById('sidebar-user-email');

            if (token && userEmail) {
                // User is logged in - Header
                userInfo.style.display = 'flex';
                loginLink.style.display = 'none';
                logoutBtn.style.display = 'block';
                if (userEmailElement) {
                    userEmailElement.textContent = userEmail;
                }

                // User is logged in - Sidebar
                if (sidebarUserInfo) sidebarUserInfo.style.display = 'block';
                if (sidebarLoginLink) sidebarLoginLink.style.display = 'none';
                if (sidebarLogoutBtn) sidebarLogoutBtn.style.display = 'block';
                if (sidebarUserEmail) sidebarUserEmail.textContent = userEmail;
            } else {
                // User is not logged in - Header
                userInfo.style.display = 'none';
                loginLink.style.display = 'block';
                logoutBtn.style.display = 'none';

                // User is not logged in - Sidebar
                if (sidebarUserInfo) sidebarUserInfo.style.display = 'none';
                if (sidebarLoginLink) sidebarLoginLink.style.display = 'block';
                if (sidebarLogoutBtn) sidebarLogoutBtn.style.display = 'none';
            }
        }
/* =========================================================
   GLOBAL CONFIG (SAFE – NO DUPLICATE)
========================================================= */
(function () {
    window.APP_CONFIG = window.APP_CONFIG || {};
    window.APP_CONFIG.API_BASE_URL =
        location.hostname === 'localhost' || location.hostname === '127.0.0.1'
            ? 'http://127.0.0.1:8000/api/v1'
            : 'https://api.vietdataverse.online/api/v1';
    // Warm up API connection early (triggers DNS + TLS handshake)
    if (location.hostname !== 'localhost' && location.hostname !== '127.0.0.1') {
        fetch('https://api.vietdataverse.online/api/v1/health', { mode: 'cors', cache: 'no-store' }).catch(() => {});
    }
})();

/* =========================================================
   DOM READY
========================================================= */
document.addEventListener('DOMContentLoaded', async () => {
    initHeaderActions();
    initMobileMenu();
    initSidebarTabs();
    initChartTabs();
    initFilterButtons();
    initNotifications();

    // Initialize Auth0 and check authentication status
    await initAuth0AndUpdateUI();
});

/* =========================================================
   AUTH0 INITIALIZATION & UI UPDATE
========================================================= */
async function initAuth0AndUpdateUI() {
    try {
        // Initialize Auth0
        await initAuth0();

        // Check if user is authenticated
        const authenticated = await isAuthenticated();

        if (authenticated) {
            // Get user info from Auth0
            const user = await getUser();

            // GA4: track login + set user identity
            if (typeof gtag === 'function' && user) {
                gtag('set', 'user_properties', {
                    user_email: user.email || ''
                });
                gtag('event', 'login', {
                    method: 'auth0',
                    user_email: user.email || '',
                    user_name: user.name || ''
                });
            }

            // Sync user with backend DB by calling /me endpoint
            try {
                const token = await getToken();
                const apiBase = window.APP_CONFIG.API_BASE_URL;
                const response = await fetch(`${apiBase}/me`, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const dbUser = await response.json();
                    console.log('User synced with backend:', dbUser);
                } else {
                    console.warn('Failed to sync user with backend:', response.status);
                }
            } catch (err) {
                console.error('Error syncing user with backend:', err);
            }

            // Update UI to show logged-in state
            const loginLink = document.getElementById('login-link');
            const userInfo = document.getElementById('user-info');
            const userEmail = document.getElementById('user-email');
            const logoutBtn = document.getElementById('logout-btn');

            // Header
            if (loginLink) loginLink.style.display = 'none';
            if (userInfo) userInfo.style.display = 'block';
            if (userEmail) userEmail.textContent = user.email || user.name || 'User';
            if (logoutBtn) {
                logoutBtn.style.display = 'block';
                logoutBtn.addEventListener('click', () => {
                    logout();
                });
            }

            // Sidebar
            const sidebarLoginLink = document.getElementById('sidebar-login-link');
            const sidebarUserInfo = document.getElementById('sidebar-user-info');
            const sidebarUserEmail = document.getElementById('sidebar-user-email');
            const sidebarLogoutBtn = document.getElementById('sidebar-logout-btn');

            if (sidebarLoginLink) sidebarLoginLink.style.display = 'none';
            if (sidebarUserInfo) sidebarUserInfo.style.display = 'block';
            if (sidebarUserEmail) sidebarUserEmail.textContent = user.email || user.name || 'User';
            if (sidebarLogoutBtn) {
                sidebarLogoutBtn.style.display = 'block';
                sidebarLogoutBtn.addEventListener('click', () => {
                    logout();
                });
            }
        }
    } catch (err) {
        console.error('Auth0 initialization failed:', err);
    }
}

/* =========================================================
   HEADER ACTIONS: LANGUAGE + LOGIN
========================================================= */
function initHeaderActions() {
    const langBtn = document.getElementById('lang-toggle');
    const sidebarLangBtn = document.getElementById('sidebar-lang-toggle');

    /* ---------- LANGUAGE (ENG / VIE) ---------- */
    const savedLang = localStorage.getItem('lang') || 'vi';
    updateLanguage(savedLang);

    if (langBtn) {
        langBtn.addEventListener('click', () => {
            const current = document.documentElement.lang || 'vi';
            const next = current === 'vi' ? 'en' : 'vi';
            updateLanguage(next);
        });
    }
    if (sidebarLangBtn) {
        sidebarLangBtn.addEventListener('click', () => {
            const current = document.documentElement.lang || 'vi';
            const next = current === 'vi' ? 'en' : 'vi';
            updateLanguage(next);
        });
    }

    /* ---------- LOGIN (notification modal) ---------- */
    const loginBtn = document.getElementById('login-btn');
    if (loginBtn) {
        loginBtn.addEventListener('click', () => {
            // Close notification overlay first
            const overlay = document.getElementById('notification-overlay');
            if (overlay) overlay.classList.remove('active');
            // Use Auth0 login
            if (typeof login === 'function') login();
        });
    }
}

/* =========================================================
   LANGUAGE HANDLER (UI-LEVEL, STABLE)
========================================================= */
function setLanguage(lang) {
    document.documentElement.lang = lang;
    localStorage.setItem('lang', lang);

    const label = lang === 'vi' ? 'EN / VIE' : 'VIE / EN';

    // Update header lang button
    const langText = document.getElementById('lang-text');
    if (langText) langText.textContent = label;

    // Update sidebar lang button
    const sidebarText = document.getElementById('sidebar-lang-text');
    if (sidebarText) sidebarText.textContent = label;

    document.body.setAttribute('data-lang', lang);
}

/* =========================================================
   MOBILE MENU
========================================================= */
function initMobileMenu() {
    const toggle = document.getElementById('mobile-menu-toggle');
    const sidebar = document.querySelector('.sidebar');
    const overlay = document.getElementById('mobile-overlay');

    if (!toggle || !sidebar || !overlay) return;

    toggle.addEventListener('click', () => {
        sidebar.classList.toggle('active');
        overlay.classList.toggle('active');
    });

    overlay.addEventListener('click', () => {
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
    });
}

/* =========================================================
   SIDEBAR TABS (main-level only)
========================================================= */
let _tabDwellTimer = null;
const TAB_LABELS = {
    'data-portal': 'Open Economic Data',
    '1smarket-portal': '1s Market Pulse',
    'fintel-agent-for-hire': 'Fintel AI Agent',
    'download-api': 'Download & API',
    'about-terms': 'About & Terms'
};

function activateTab(tabId) {
    // GA4: track tab view
    if (typeof gtag === 'function') {
        gtag('event', 'tab_view', {
            tab_id: tabId,
            tab_name: TAB_LABELS[tabId] || tabId,
            product_type: (tabId === 'fintel-agent-for-hire') ? 'profit' : 'free'
        });
    }

    // GA4: track tab engagement (stayed 5s+)
    if (_tabDwellTimer) clearTimeout(_tabDwellTimer);
    _tabDwellTimer = setTimeout(() => {
        if (typeof gtag === 'function') {
            gtag('event', 'tab_engaged', {
                tab_id: tabId,
                tab_name: TAB_LABELS[tabId] || tabId,
                dwell_seconds: 5
            });
        }
    }, 5000);

    // Toggle nav-links
    document.querySelectorAll('.nav-link[data-tab]').forEach(l => l.classList.remove('active'));
    const activeNav = document.querySelector(`.nav-link[data-tab="${tabId}"]`);
    if (activeNav) activeNav.classList.add('active');

    // Toggle tab-content
    document.querySelectorAll('.main-content > .tab-content').forEach(c => c.classList.remove('active'));
    const target = document.getElementById(tabId);
    if (target) target.classList.add('active');

    // If switching to data-portal, restore the inner chart tab
    if (tabId === 'data-portal') {
        const activeChartTab = document.querySelector('.chart-tab-btn.active');
        if (activeChartTab) {
            const innerTabId = activeChartTab.dataset.tab;
            const innerTarget = document.getElementById(innerTabId);
            if (innerTarget) innerTarget.classList.add('active');
        }
    }

    // Close mobile sidebar
    const sidebar = document.querySelector('.sidebar');
    const mobileOverlay = document.getElementById('mobile-overlay');
    if (sidebar) sidebar.classList.remove('active');
    if (mobileOverlay) mobileOverlay.classList.remove('active');
}

function initSidebarTabs() {
    // Nav-link tab clicks
    document.querySelectorAll('.nav-link[data-tab]').forEach(link => {
        link.addEventListener('click', () => activateTab(link.dataset.tab));
    });

    // Sidebar bottom link (About & Terms)
    const bottomLink = document.querySelector('.sidebar-bottom-link[data-tab]');
    if (bottomLink) {
        bottomLink.addEventListener('click', (e) => {
            e.preventDefault();
            activateTab(bottomLink.dataset.tab);
        });
    }

    // Handle URL hash on page load (e.g. index.html#about-terms from partners.html)
    const hash = window.location.hash.replace('#', '');
    if (hash && document.getElementById(hash)) {
        activateTab(hash);
    }
}

/* =========================================================
   CHART SUB-TABS (Vang & Bac / Tien te VN / Quoc te)
   WITH LAZY LOADING
========================================================= */
function initChartTabs() {
    document.querySelectorAll('.chart-tab-btn[data-tab]').forEach(btn => {
        btn.addEventListener('click', () => {
            const tabId = btn.dataset.tab;

            // Toggle button active states
            document.querySelectorAll('.chart-tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            // Toggle inner tab-contents within charts-section
            const chartsSection = btn.closest('.charts-section');
            if (chartsSection) {
                chartsSection.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            }
            const target = document.getElementById(tabId);
            if (target) target.classList.add('active');

            // Lazy load charts when tab is clicked for the first time
            loadChartsForTab(tabId);
        });
    });

    // Load the first tab (gold & silver) immediately on page load
    loadChartsForTab('tab-gold-silver');
}

/* =========================================================
   LAZY LOAD CHARTS FOR A SPECIFIC TAB
========================================================= */
function loadChartsForTab(tabId) {
    // Skip if already loaded
    if (loadedTabs[tabId]) {
        return;
    }

    loadedTabs[tabId] = true;

    // Load charts in parallel for each tab
    if (tabId === 'tab-gold-silver') {
        const goldType = document.getElementById('goldTypeSelect')?.value || 'DOJI HN';
        Promise.all([
            loadChartData('gold', '1m', goldType),
            loadChartData('silver', '1m')
        ]);
    } else if (tabId === 'tab-currency') {
        const bankCode = document.getElementById('bankTypeSelect')?.value || 'ACB';
        Promise.all([
            loadChartData('td', '1y', null, bankCode),
            loadChartData('sbv', '1m')
        ]);
    } else if (tabId === 'tab-global') {
        loadChartData('global', '1m');
    }
}

/* =========================================================
   FILTER BUTTONS & DROPDOWNS
========================================================= */
function initFilterButtons() {
    // Period filter buttons
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const chart = btn.dataset.chart;
            const period = btn.dataset.period;

            // Update active state
            btn.parentElement
                ?.querySelectorAll('.filter-btn')
                .forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            // Get additional parameters
            let goldType = null;
            let bankCode = null;

            if (chart === 'gold') {
                goldType = document.getElementById('goldTypeSelect')?.value || 'DOJI HN';
            } else if (chart === 'td') {
                bankCode = document.getElementById('bankTypeSelect')?.value || 'ACB';
            }

            // Load chart data with updated period
            loadChartData(chart, period, goldType, bankCode);
        });
    });

    // Gold type selector
    const goldTypeSelect = document.getElementById('goldTypeSelect');
    if (goldTypeSelect) {
        goldTypeSelect.addEventListener('change', (e) => {
            const goldType = e.target.value;
            // Get current active period
            const activePeriodBtn = document.querySelector('.filter-btn[data-chart="gold"].active');
            const period = activePeriodBtn?.dataset.period || '1m';
            // Reload gold chart with new type
            loadChartData('gold', period, goldType);
        });
    }

    // Bank type selector
    const bankTypeSelect = document.getElementById('bankTypeSelect');
    if (bankTypeSelect) {
        bankTypeSelect.addEventListener('change', (e) => {
            const bankCode = e.target.value;
            // Get current active period
            const activePeriodBtn = document.querySelector('.filter-btn[data-chart="td"].active');
            const period = activePeriodBtn?.dataset.period || '1y';
            // Reload TD chart with new bank
            loadChartData('td', period, null, bankCode);
        });
    }
}

/* =========================================================
   NOTIFICATION OVERLAYS
========================================================= */
function initNotifications() {
    // Download notification - cancel
    const cancelBtn = document.getElementById('cancel-btn');
    if (cancelBtn) {
        cancelBtn.addEventListener('click', () => {
            const overlay = document.getElementById('notification-overlay');
            if (overlay) overlay.classList.remove('active');
        });
    }

    // API notification - cancel
    const apiCancelBtn = document.getElementById('api-cancel-btn');
    if (apiCancelBtn) {
        apiCancelBtn.addEventListener('click', () => {
            const overlay = document.getElementById('api-notification-overlay');
            if (overlay) overlay.classList.remove('active');
        });
    }

    // API notification - signup
    const apiSignupBtn = document.getElementById('api-signup-btn');
    if (apiSignupBtn) {
        apiSignupBtn.addEventListener('click', () => {
            const overlay = document.getElementById('api-notification-overlay');
            if (overlay) overlay.classList.remove('active');
            if (typeof signup === 'function') signup();
        });
    }

    // Download buttons -> show login notification if not authenticated, or trigger download
    document.querySelectorAll('[data-download]').forEach(btn => {
        btn.addEventListener('click', async () => {
            const authed = typeof isAuthenticated === 'function' && await isAuthenticated();
            if (!authed) {
                const overlay = document.getElementById('notification-overlay');
                if (overlay) overlay.classList.add('active');
                return;
            }

            // User is authenticated - trigger actual download
            const dataType = btn.dataset.download;
            await downloadData(dataType);
        });
    });

    // API buttons -> check authentication status
    document.querySelectorAll('[data-api]').forEach(btn => {
        btn.addEventListener('click', async () => {
            const authed = typeof isAuthenticated === 'function' && await isAuthenticated();
            const overlay = document.getElementById('api-notification-overlay');
            const signupBtn = document.getElementById('api-signup-btn');

            if (authed) {
                // User is logged in - hide signup button
                if (signupBtn) signupBtn.style.display = 'none';
            } else {
                // User is not logged in - show signup button
                if (signupBtn) signupBtn.style.display = 'inline-flex';
            }

            if (overlay) overlay.classList.add('active');
        });
    });
}

/* =========================================================
   DOWNLOAD DATA FUNCTIONALITY
========================================================= */
async function downloadData(dataType) {
    const base = window.APP_CONFIG.API_BASE_URL;

    // Map data types to API endpoints
    const endpointMap = {
        'gold': 'gold?period=all',
        'silver': 'silver?period=all',
        'sbv': 'sbv-interbank?period=all'
    };

    const endpoint = endpointMap[dataType];
    if (!endpoint) {
        console.error('Unknown data type:', dataType);
        return;
    }

    try {
        // Show loading state (optional - could add a loading indicator)
        console.log(`Downloading ${dataType} data...`);

        // Fetch data from API
        const response = await fetch(`${base}/${endpoint}`);
        if (!response.ok) throw new Error('Failed to fetch data');

        const jsonData = await response.json();

        if (!jsonData.success || !jsonData.data) {
            throw new Error('Invalid data format');
        }

        // Convert to CSV
        let csvContent = '';
        const data = jsonData.data;

        if (dataType === 'gold' || dataType === 'silver') {
            // CSV header
            csvContent = 'Date,Buy Price,Sell Price\n';

            // CSV rows
            for (let i = 0; i < data.dates.length; i++) {
                csvContent += `${data.dates[i]},${data.buy_prices[i]},${data.sell_prices[i]}\n`;
            }
        } else if (dataType === 'sbv') {
            // CSV header
            csvContent = 'Date,Overnight,1 Month,3 Months,Rediscount,Refinancing\n';

            // CSV rows
            for (let i = 0; i < data.dates.length; i++) {
                csvContent += `${data.dates[i]},${data.overnight[i]},${data.month_1[i]},${data.month_3[i]},${data.rediscount[i]},${data.refinancing[i]}\n`;
            }
        }

        // Create blob and trigger download
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);

        link.setAttribute('href', url);
        link.setAttribute('download', `vietdataverse_${dataType}_${new Date().toISOString().split('T')[0]}.csv`);
        link.style.visibility = 'hidden';

        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);

        console.log(`Downloaded ${dataType} data successfully`);

        // GA4: track file download
        if (typeof gtag === 'function') {
            gtag('event', 'file_download', {
                file_name: `vietdataverse_${dataType}`,
                file_type: 'csv',
                data_type: dataType
            });
        }

    } catch (error) {
        console.error('Download failed:', error);
        alert('Download failed. Please try again.');
    }
}

/* =========================================================
   CHART RENDERING SYSTEM WITH LAZY LOADING & CACHING
========================================================= */

// Store Chart.js instances
const chartInstances = {
    gold: null,
    silver: null,
    td: null,
    sbv: null,
    global: null
};

// Cache for loaded data (avoid redundant API calls)
const chartCache = {};

// Track which tabs have been loaded
const loadedTabs = {
    'tab-gold-silver': false,
    'tab-currency': false,
    'tab-global': false
};

// Map chart types to their API endpoints
const CHART_API_ENDPOINTS = {
    gold: 'gold',
    silver: 'silver',
    td: 'termdepo',
    sbv: 'sbv-interbank',
    global: 'global-macro'
};

/* =========================================================
   FETCH CHART DATA - STATIC CDN FIRST, API FALLBACK
========================================================= */
async function loadChartData(chartType, period = '1m', goldType = 'DOJI HN', bankCode = 'ACB') {
    const base = window.APP_CONFIG.API_BASE_URL;
    if (!chartType) return;

    const endpoint = CHART_API_ENDPOINTS[chartType];
    if (!endpoint) { console.error('Unknown chart type:', chartType); return; }

    const cacheKey = `${chartType}-${period}-${goldType}-${bankCode}`;
    if (chartCache[cacheKey]) {
        console.log(`[${chartType}] Using cached data`);
        renderChart(chartType, chartCache[cacheKey], period);
        return;
    }

    const loadingEl = document.getElementById(`${chartType}Loading`);
    if (loadingEl) loadingEl.style.display = 'flex';

    let data = null;
    try {
        // Fetch directly from API
        if (base) {
            let apiUrl = `${base}/${endpoint}?period=${period}`;
            if (chartType === 'gold' && goldType) apiUrl += `&type=${encodeURIComponent(goldType)}`;
            if (chartType === 'td' && bankCode) apiUrl += `&bank=${encodeURIComponent(bankCode)}`;
            const res = await fetch(apiUrl);
            if (!res.ok) throw new Error(`API error: ${res.status}`);
            data = await res.json();
        }

        if (data) { chartCache[cacheKey] = data; renderChart(chartType, data, period); }
        else { throw new Error('No data source available'); }

    } catch (e) {
        console.error(`[${chartType}] All fetch failed:`, e);
        if (loadingEl) loadingEl.innerHTML = '<p style="color: #EF5350; text-align: center;">Failed to load data. Please try again.</p>';
    } finally {
        setTimeout(() => { if (loadingEl) loadingEl.style.display = 'none'; }, 500);
    }
}

/* =========================================================
   RENDER CHART WITH CHART.JS
========================================================= */
function renderChart(chartType, apiData, period) {
    const canvas = document.getElementById(`${chartType}Chart`);
    if (!canvas) {
        console.error(`Canvas not found for ${chartType}Chart`);
        return;
    }

    const ctx = canvas.getContext('2d');

    // Destroy existing chart instance if it exists
    if (chartInstances[chartType]) {
        chartInstances[chartType].destroy();
    }

    // Parse data based on chart type
    let chartData;
    if (chartType === 'gold' || chartType === 'silver') {
        chartData = parseGoldSilverData(apiData, chartType);
    } else if (chartType === 'td') {
        chartData = parseTDData(apiData);
    } else if (chartType === 'sbv') {
        chartData = parseSBVData(apiData);
    } else if (chartType === 'global') {
        chartData = parseGlobalData(apiData);
    }

    if (!chartData) {
        console.error(`Failed to parse data for ${chartType}`);
        return;
    }

    // Create new chart
    chartInstances[chartType] = new Chart(ctx, chartData);
}

/* =========================================================
   DATA PARSERS FOR DIFFERENT CHART TYPES
========================================================= */
function parseGoldSilverData(apiData, chartType) {
    // API format: { success: true, data: { dates: [...], buy_prices: [...], sell_prices: [...] } }
    if (!apiData || !apiData.data || !apiData.data.dates) {
        console.warn(`No data for ${chartType}`);
        return null;
    }

    const dates = apiData.data.dates;
    const buyPrices = apiData.data.buy_prices;
    const sellPrices = apiData.data.sell_prices;

    const color = chartType === 'gold' ? '#C9A55B' : '#A0A0A0';

    return {
        type: 'line',
        data: {
            labels: dates,
            datasets: [
                {
                    label: 'Buy Price (Mua vào)',
                    data: buyPrices,
                    borderColor: color,
                    backgroundColor: color + '20',
                    borderWidth: 2,
                    tension: 0.4,
                    fill: true
                },
                {
                    label: 'Sell Price (Bán ra)',
                    data: sellPrices,
                    borderColor: color + 'CC',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    tension: 0.4,
                    borderDash: [5, 5]
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    labels: { color: '#A0A0A0' }
                },
                tooltip: {
                    mode: 'index',
                    intersect: false
                }
            },
            scales: {
                x: {
                    ticks: { color: '#666', maxRotation: 45 },
                    grid: { color: '#2A2A2A' }
                },
                y: {
                    ticks: { color: '#666' },
                    grid: { color: '#2A2A2A' }
                }
            }
        }
    };
}

function parseTDData(apiData) {
    // API format: { success: true, data: { dates: [...], term_1m: [...], term_3m: [...], ... } }
    if (!apiData || !apiData.data || !apiData.data.dates) {
        return null;
    }

    const dates = apiData.data.dates;
    const rate1m = apiData.data.term_1m;
    const rate3m = apiData.data.term_3m;
    const rate6m = apiData.data.term_6m;
    const rate12m = apiData.data.term_12m;

    return {
        type: 'line',
        data: {
            labels: dates,
            datasets: [
                {
                    label: '1 Month',
                    data: rate1m,
                    borderColor: '#42A5F5',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    tension: 0.4
                },
                {
                    label: '3 Months',
                    data: rate3m,
                    borderColor: '#66BB6A',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    tension: 0.4
                },
                {
                    label: '6 Months',
                    data: rate6m,
                    borderColor: '#FFA726',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    tension: 0.4
                },
                {
                    label: '12 Months',
                    data: rate12m,
                    borderColor: '#EF5350',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    tension: 0.4
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    labels: { color: '#A0A0A0' }
                },
                tooltip: {
                    mode: 'index',
                    intersect: false
                }
            },
            scales: {
                x: {
                    ticks: { color: '#666', maxRotation: 45 },
                    grid: { color: '#2A2A2A' }
                },
                y: {
                    ticks: {
                        color: '#666',
                        callback: function(value) {
                            return value + '%';
                        }
                    },
                    grid: { color: '#2A2A2A' }
                }
            }
        }
    };
}

function parseSBVData(apiData) {
    // API format: { success: true, data: { dates: [...], overnight: [...], month_1: [...], month_3: [...] } }
    if (!apiData || !apiData.data || !apiData.data.dates) {
        return null;
    }

    const dates = apiData.data.dates;
    const overnight = apiData.data.overnight;
    const onweek = apiData.data.month_1;  // Using month_1 as "1 week" equivalent
    const twoweek = apiData.data.month_3;  // Using month_3 as "2 weeks" equivalent

    return {
        type: 'line',
        data: {
            labels: dates,
            datasets: [
                {
                    label: 'Overnight',
                    data: overnight,
                    borderColor: '#C9A55B',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    tension: 0.4
                },
                {
                    label: '1 Week',
                    data: onweek,
                    borderColor: '#42A5F5',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    tension: 0.4
                },
                {
                    label: '2 Weeks',
                    data: twoweek,
                    borderColor: '#66BB6A',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    tension: 0.4
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    labels: { color: '#A0A0A0' }
                },
                tooltip: {
                    mode: 'index',
                    intersect: false
                }
            },
            scales: {
                x: {
                    ticks: { color: '#666', maxRotation: 45 },
                    grid: { color: '#2A2A2A' }
                },
                y: {
                    ticks: {
                        color: '#666',
                        callback: function(value) {
                            return value + '%';
                        }
                    },
                    grid: { color: '#2A2A2A' }
                }
            }
        }
    };
}

function parseGlobalData(apiData) {
    // API format: { success: true, data: { dates: [...], gold_prices: [...], silver_prices: [...], nasdaq_prices: [...] } }
    if (!apiData || !apiData.data || !apiData.data.dates) {
        return null;
    }

    const dates = apiData.data.dates;
    const goldFuture = apiData.data.gold_prices;
    const silverSpot = apiData.data.silver_prices;
    const nasdaq = apiData.data.nasdaq_prices;

    return {
        type: 'line',
        data: {
            labels: dates,
            datasets: [
                {
                    label: 'Gold Future ($/oz)',
                    data: goldFuture,
                    borderColor: '#C9A55B',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    tension: 0.4,
                    yAxisID: 'y'
                },
                {
                    label: 'Silver Spot ($/oz)',
                    data: silverSpot,
                    borderColor: '#A0A0A0',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    tension: 0.4,
                    yAxisID: 'y1'
                },
                {
                    label: 'NASDAQ',
                    data: nasdaq,
                    borderColor: '#42A5F5',
                    backgroundColor: 'transparent',
                    borderWidth: 2,
                    tension: 0.4,
                    yAxisID: 'y2'
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: {
                mode: 'index',
                intersect: false
            },
            plugins: {
                legend: {
                    display: true,
                    labels: { color: '#A0A0A0' }
                },
                tooltip: {
                    mode: 'index',
                    intersect: false
                }
            },
            scales: {
                x: {
                    ticks: { color: '#666', maxRotation: 45 },
                    grid: { color: '#2A2A2A' }
                },
                y: {
                    type: 'linear',
                    display: true,
                    position: 'left',
                    ticks: { color: '#C9A55B' },
                    grid: { color: '#2A2A2A' }
                },
                y1: {
                    type: 'linear',
                    display: true,
                    position: 'right',
                    ticks: { color: '#A0A0A0' },
                    grid: { drawOnChartArea: false }
                },
                y2: {
                    type: 'linear',
                    display: false,
                    position: 'right'
                }
            }
        }
    };
}

/* =========================================================
   MARKET PULSE - LOAD & RENDER ARTICLES
========================================================= */
const LABEL_COLORS = {
    VNINDEX: '#4CAF50',
    GOLD: '#C9A55B',
    REAL_ESTATE: '#FF7043',
    BANKING: '#42A5F5',
    FX: '#AB47BC'
};

const LABEL_NAMES_VI = {
    VNINDEX: 'VN-Index',
    GOLD: 'Vang',
    REAL_ESTATE: 'BDS',
    BANKING: 'Ngan hang',
    FX: 'Ngoai hoi'
};

function formatPulseDate(isoStr) {
    if (!isoStr) return '';
    try {
        const d = new Date(isoStr);
        return d.toLocaleDateString('vi-VN', { day: '2-digit', month: '2-digit', year: 'numeric', hour: '2-digit', minute: '2-digit' });
    } catch { return isoStr; }
}

function renderMriBadge(mri) {
    if (mri == null) return '';
    const color = mri > 0 ? '#4CAF50' : mri < 0 ? '#EF5350' : '#888';
    const arrow = mri > 0 ? '&#9650;' : mri < 0 ? '&#9660;' : '&#9654;';
    return `<span style="display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:4px;font-size:0.8rem;font-weight:600;color:${color};background:${color}1a;">${arrow} MRI ${mri > 0 ? '+' : ''}${mri}</span>`;
}

function renderPulseArticle(item) {
    const labelColor = LABEL_COLORS[item.label] || '#888';
    return `
    <article class="article-featured" style="margin-bottom:1.5rem;">
        <div class="article-header" style="padding:1.5rem 2rem 1rem;">
            <div style="display:flex;align-items:center;gap:0.75rem;flex-wrap:wrap;margin-bottom:0.75rem;">
                <span class="article-tag" style="border-color:${labelColor}40;color:${labelColor};background:${labelColor}15;margin-bottom:0;">${item.label || 'NEWS'}</span>
                ${renderMriBadge(item.mri)}
            </div>
            <h2 class="article-title" style="font-size:1.5rem;margin-bottom:0.75rem;">
                <a href="${item.url || '#'}" target="_blank" rel="noopener" style="color:inherit;text-decoration:none;">${item.title || 'Untitled'}</a>
            </h2>
            <div class="article-meta">
                <span class="meta-item">${item.source_name || ''}</span>
                <span class="meta-item">${formatPulseDate(item.generated_at)}</span>
            </div>
        </div>
        <div class="article-body" style="padding:1rem 2rem 1.5rem;">
            <div class="article-text">
                <p style="margin:0;">${item.brief_content || ''}</p>
            </div>
        </div>
    </article>`;
}

// Market Pulse data cache for filtering
let pulseDataCache = [];

async function loadMarketPulse() {
    const base = window.APP_CONFIG.API_BASE_URL;
    const container = document.getElementById('market-pulse-articles');
    if (!container) return;

    const lang = localStorage.getItem('lang') || 'vi';
    let data = null;

    try {
        // Fetch directly from API
        if (base) {
            const res = await fetch(`${base}/market-pulse?lang=${lang}&limit=20`);
            if (res.ok) {
                const json = await res.json();
                data = json.data || [];
            }
        }

        if (!data || data.length === 0) {
            container.innerHTML = '<p style="text-align:center;color:var(--text-tertiary);padding:3rem;">Chua co bai viet nao.</p>';
            return;
        }

        pulseDataCache = data;
        renderFilteredPulse();
    } catch (e) {
        console.error('Market Pulse fetch failed:', e);
        container.innerHTML = '<p style="text-align:center;color:var(--text-tertiary);padding:3rem;">Khong the tai du lieu.</p>';
    }
}

function renderFilteredPulse() {
    const container = document.getElementById('market-pulse-articles');
    if (!container) return;

    const sourceFilter = document.getElementById('filter-source')?.value || '';
    const labelFilter = document.getElementById('filter-label')?.value || '';
    const mriFilter = document.getElementById('filter-mri')?.value || '';

    let filtered = pulseDataCache;
    if (sourceFilter) filtered = filtered.filter(i => i.source_name?.includes(sourceFilter));
    if (labelFilter) filtered = filtered.filter(i => i.label === labelFilter);
    if (mriFilter === 'positive') filtered = filtered.filter(i => i.mri > 0);
    else if (mriFilter === 'negative') filtered = filtered.filter(i => i.mri < 0);

    if (filtered.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:var(--text-tertiary);padding:3rem;">Khong co ket qua phu hop.</p>';
        return;
    }
    container.innerHTML = filtered.slice(0, 10).map(renderPulseArticle).join('');
}

// Initialize Market Pulse with filter listeners
document.addEventListener('DOMContentLoaded', () => {
    loadMarketPulse();
    ['filter-source', 'filter-label', 'filter-mri'].forEach(id => {
        document.getElementById(id)?.addEventListener('change', renderFilteredPulse);
    });
    document.getElementById('filter-reset')?.addEventListener('click', () => {
        document.getElementById('filter-source').value = '';
        document.getElementById('filter-label').value = '';
        document.getElementById('filter-mri').value = '';
        renderFilteredPulse();
    });
});

// ============================================================
// SAVE INTEREST - Per-item bookmark buttons for tracking
// ============================================================
const SAVED_INTERESTS_KEY = 'vietdataverse_saved_interests';

function getFingerprint() {
    // Simple browser fingerprint for anonymous tracking
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    ctx.textBaseline = 'top';
    ctx.font = '14px Arial';
    ctx.fillText('fingerprint', 2, 2);
    const fp = canvas.toDataURL().slice(-50);
    const nav = navigator.userAgent + navigator.language + screen.width + screen.height;
    return btoa(fp + nav).slice(0, 32);
}

function getSavedInterests() {
    try {
        return JSON.parse(localStorage.getItem(SAVED_INTERESTS_KEY) || '{}');
    } catch {
        return {};
    }
}

function setSavedInterest(interestType) {
    const saved = getSavedInterests();
    saved[interestType] = Date.now();
    localStorage.setItem(SAVED_INTERESTS_KEY, JSON.stringify(saved));
}

function isInterestSaved(interestType) {
    const saved = getSavedInterests();
    return !!saved[interestType];
}

async function saveInterest(btn, interestType) {
    if (!btn || !interestType) return;

    // Build auth headers if user is logged in
    let authHeaders = {};
    let userEmail = null;
    try {
        const token = await getToken();
        if (token) {
            authHeaders['Authorization'] = 'Bearer ' + token;
            const user = await getUser();
            if (user) userEmail = user.email || null;
        }
    } catch (e) { /* anonymous fallback */ }

    // Check if already saved — toggle off (unsave)
    if (isInterestSaved(interestType)) {
        const saved = getSavedInterests();
        delete saved[interestType];
        localStorage.setItem(SAVED_INTERESTS_KEY, JSON.stringify(saved));
        btn.classList.remove('saved');
        btn.title = 'Lưu quan tâm';

        // GA4: track unsave event
        if (typeof gtag === 'function') {
            gtag('event', 'unsave_interest', {
                interest_type: interestType,
                user_email: userEmail || 'anonymous'
            });
        }

        // Notify backend to remove interest
        try {
            await fetch(`${API_BASE}/api/v1/interest/${interestType}`, {
                method: 'DELETE',
                headers: { 'Content-Type': 'application/json', ...authHeaders },
                body: JSON.stringify({ fingerprint: getFingerprint() })
            });
        } catch (err) {
            console.error('Delete interest error:', err);
        }
        return;
    }

    // Save interest
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';

    try {
        const fingerprint = getFingerprint();
        await fetch(`${API_BASE}/api/v1/interest/${interestType}`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', ...authHeaders },
            body: JSON.stringify({
                fingerprint: fingerprint,
                email: userEmail,
                source: 'web',
                user_agent: navigator.userAgent,
                language: navigator.language
            })
        });
    } catch (err) {
        console.error('Save interest error:', err);
    }

    // GA4: track save event
    if (typeof gtag === 'function') {
        gtag('event', 'save_interest', {
            interest_type: interestType,
            user_email: userEmail || 'anonymous'
        });
    }

    // Always mark as saved locally (even if API fails)
    setSavedInterest(interestType);
    btn.innerHTML = '<i class="fas fa-bookmark"></i>';
    btn.classList.add('saved');
    btn.title = 'Đã lưu - Click để bỏ lưu';
    btn.disabled = false;
}

// Initialize all save interest buttons
document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.save-interest-btn').forEach(btn => {
        const interestType = btn.getAttribute('data-interest');
        if (!interestType) return;

        // Restore saved state
        if (isInterestSaved(interestType)) {
            btn.classList.add('saved');
            btn.title = 'Đã lưu - Click để bỏ lưu';
        }

        // Add click handler
        btn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            saveInterest(btn, interestType);
        });
    });
});
</script>


</body>
</html>